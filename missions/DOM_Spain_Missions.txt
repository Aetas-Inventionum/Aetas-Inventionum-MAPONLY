ai_cas_branch_1 = {
	slot = 1
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = CAS
			was_tag = CAS
		}
	}

	spa_vivero = {
		icon = mission_valladolid
		position = 1
		provinces_to_highlight = { 
			province_id = 215
			NOT = { 
				AND = { 
					num_of_times_improved = 5
					has_tax_building_trigger = yes 
					owned_by = ROOT 
					is_core = ROOT 
					is_capital = yes 
				}
			}
		} 

		trigger = {  
			215 = { 
				num_of_times_improved = 5
				has_tax_building_trigger = yes 
				owned_by = ROOT 
				is_core = ROOT 
				is_capital = yes 
			}
		} 

		effect = {  
			215 = { 
				add_building = courthouse
				add_province_triggered_modifier = valladolid_chancelleria
			}
		} 
	}

	cas_toledo = {
		icon = mission_toledo
		position = 2
		required_missions = { spa_vivero } 
		provinces_to_highlight = {  
			province_id = 219
			NOT = { 
				AND = { 
					owned_by = ROOT 
					is_core = ROOT 
					num_of_times_improved = 10
					is_capital = yes 
				}
			}
		} 

		trigger = {  
			219 = { 
				owned_by = ROOT 
				is_core = ROOT 
				num_of_times_improved = 10
				is_capital = yes 
			}
		} 

		effect = {  
			219 = { 
				add_province_modifier = { 
					name = real_toledo
					duration = -1
				}
			}
		} 
	}

	spa_alcala = {
		icon = mission_cisneros
		position = 3
		required_missions = { spa_salamanca } 
		provinces_to_highlight = {  
			province_id = 4948
			NOT = { 
				AND = { 
					owned_by = ROOT 
					is_core = ROOT 
					has_cardinal = yes 
					renaissance = 100
				}
			}
		} 

		trigger = {  
			4948 = { 
				owned_by = ROOT 
				is_core = ROOT 
				has_cardinal = yes 
				renaissance = 100
			}
		} 

		effect = { country_event = { id = aetas_cas.26 } } 
	}
}
ai_spa_branch_1a = {
	slot = 1
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = SPA
			tag = SPN
			was_tag = SPA
		}
		was_tag = CAS
	}

	spa_solo = {
		icon = mission_madrid_plaza
		position = 4
		required_missions = { spa_alcala } 
		provinces_to_highlight = {
			OR = {
				province_id = 217
				province_id = 215
				province_id = 219
				province_id = 4789
			}
			NOT = {
				AND = {
					is_capital = yes
					num_of_times_improved = 10
					has_tax_building_trigger = yes
					has_trade_building_trigger = yes
					has_production_building_trigger = yes
				}
			}
		}

		trigger = {
			adm_tech = 10
			217 = {
				num_of_times_improved = 10
				has_tax_building_trigger = yes
				has_trade_building_trigger = yes
				has_production_building_trigger = yes
			}
		}

		effect = {
			country_event = { id = flavor_spa.6 }
		}
	}

	spa_el_esc = {
		icon = spa_new_capital
		position = 4
		required_missions = {
			spa_solo
			spa_annex_orders
		}
		provinces_to_highlight = {
			province_id = 217
			NOT = {
				has_great_project = {
					type = el_escorial
					tier = 1
				}
			}
		}

		trigger = {
			217 = {
				has_great_project = {
					type = el_escorial
					tier = 1
				}
			}
		}

		effect = {
			country_event = { id = flavor_spa.23 } 
			217 = { change_trade_goods = books } 
		}
	}
}
ai_cas_locked_branch_1a = {
	slot = 1
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = CAS } 

	cas_locked_1a = {
		icon = mission_locked_mission
		position = 4
		required_missions = { spa_alcala } 
		provinces_to_highlight = {
			OR = {
				province_id = 217
				province_id = 215
				province_id = 219
				province_id = 4789
			}
			NOT = {
				AND = {
					is_capital = yes
					num_of_times_improved = 10
					has_tax_building_trigger = yes
					has_trade_building_trigger = yes
					has_production_building_trigger = yes
				}
			}
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			adm_tech = 10
			217 = {
				num_of_times_improved = 10
				has_tax_building_trigger = yes
				has_trade_building_trigger = yes
				has_production_building_trigger = yes
			}
		}

		effect = {
			custom_tooltip = spa_unlock_mission.tt
			country_event = { id = flavor_spa.6 }
		}
	}

	cas_locked_1b = {
		icon = mission_locked_mission
		position = 5
		required_missions = {
			cas_locked_1a
			spa_annex_orders
		}
		provinces_to_highlight = {
			province_id = 217
			NOT = {
				has_great_project = {
					type = el_escorial
					tier = 1
				}
			}
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			217 = {
				has_great_project = {
					type = el_escorial
					tier = 1
				}
			}
		}

		effect = {
			custom_tooltip = spa_unlock_mission.tt
			country_event = { id = flavor_spa.23 } 
			217 = { change_trade_goods = books } 
		}
	}
}
ai_cas_branch_1b = {
	slot = 1
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = CAS
			was_tag = CAS
		}
	}

	spa_habs = {
		icon = the_viennese_waltz
		position = 6
		provinces_to_highlight = {  } 

		trigger = {  
			OR = { 
				AND = { 
					NOT = { 
						OR = { 
							is_rival = HAB 
							is_enemy = HAB 
							offensive_war_with = HAB 
							defensive_war_with = HAB 
							is_rival = STY 
							is_enemy = STY 
							offensive_war_with = STY 
							defensive_war_with = STY 
							is_lesser_in_union = yes 
						}
					}
					OR = { 
						AND = { 
							marriage_with = HAB 
							HAB = { 
								is_enemy = FRA 
								is_lesser_in_union = no
							} 
						}
						AND = { 
							marriage_with = STY
							STY = { 
								is_enemy = FRA 
								is_lesser_in_union = no
							} 
						}
						AND = { 
							HAB = { exists = no }
							STY = { exists = no }
						}
					}
					is_enemy = FRA 
				}
				dynasty = "von Habsburg"
			}
		} 

		effect = {  
			if = { 
				limit = { 
					NOT = { dynasty = "von Habsburg" }
					any_province = { 
						region = low_countries_region
						OR = { 
							country_or_non_sovereign_subject_holds = HAB 
							country_or_non_sovereign_subject_holds = STY 
						}
					}
				}
				country_event = { id = flavor_spa.15 }
			}
			else_if = { 
				limit = { NOT = { dynasty = "von Habsburg" } }
				country_event = { id = flavor_spa.13 } 
			}
			else = { add_prestige_or_monarch_power = { amount = 25 } }
		} 
	}

	spa_habs_reign = {
		icon = mission_felipe_I
		position = 7
		required_missions = { spa_habs } 
		provinces_to_highlight = {  
			region = iberia_region
			NOT = { 
				OR = { 
					country_or_non_sovereign_subject_holds = ROOT 
					area = trasosmontes_area
					area = beieras_area
					area = estremadura_area
					area = alentejo_area
					area = algarve_area
				}
			}
		} 

		trigger = { 
			dynasty = "von Habsburg" 
			tag = SPA
		} 

		effect = {  
			change_tag = SPN
			on_change_tag_effect = yes
			restore_country_name = yes
			swap_non_generic_missions = yes
			if = {
				limit = { NOT = { government_rank = 2 } }
				set_government_rank = 2
			}
			if = {
				limit = {
					has_custom_ideas = no
				}
				country_event = { id = ideagroups.1 } #Swap Ideas
			}
			set_country_flag = formed_hab_spain_flag
			add_prestige = 25
			if = { 
				limit = { 
					exists = BUR 
					BUR = { is_lesser_in_union = no }
				}
				add_casus_belli = {
					target = BUR
					type = cb_restore_personal_union
					months = 480
				}
			}
			else = { 
				every_province = {
					limit = { 
						NOT = {
							OR = { 
								country_or_non_sovereign_subject_holds = ROOT 
								province_id = 193
								province_id = 3398
								province_id = 3329
							}
						}
						OR = {
							area = bourgogne_area
							province_id = 1877
							area = artois_area
						}
					}
					add_core = ROOT 
				}
			}
			austria_proper_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			upper_austria_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			inner_austria_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			lower_styria_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			real_carinthia_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			carinthia_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			sumava_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			erzgebirge_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			bohemia_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			sudetes_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			add_casus_belli = {
				target = BOH
				type = cb_restore_personal_union
				months = 480
			}
			add_casus_belli = {
				target = HAB
				type = cb_restore_personal_union
				months = 480
			}
			if = {
				limit = { 
					exists = STY 
					STY = { dynasty = ROOT }
				}
				add_casus_belli = {
					target = STY
					type = cb_restore_personal_union
					months = 480
				}
			}
		} 
	}

	spa_bur = {
		icon = conquer_burgundy
		position = 8
		required_missions = { spa_habs_reign } 
		provinces_to_highlight = {  
			area = bourgogne_area
			NOT = { 
				OR = {
					province_id = 193
					province_id = 3398
					country_or_non_sovereign_subject_holds = ROOT 
				}
			}
		} 

		trigger = {  
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = { 
				area = bourgogne_area
				value = 6
			}
		} 

		effect = {  
			if = { 
				limit = {
					exists = FLA 
					NOT = { senior_union_with = FLA }
				}
				add_casus_belli = {
					target = FLA
					type = cb_restore_personal_union
					months = 480
				}
			}
			else_if = { 
				limit = { NOT = { exists = FLA }  }
				flanders_area = { 
					limit = { 
						NOT = { 
							OR = { 
								country_or_non_sovereign_subject_holds = ROOT 
								is_core = ROOT 
							}
						}
					}
					add_core = ROOT  
				}
			}
			if = { 
				limit = {
					exists = LUX 
					NOT = { senior_union_with = LUX }
				}
				add_casus_belli = {
					target = LUX
					type = cb_restore_personal_union
					months = 480
				}
			}
			else_if = { 
				limit = { NOT = { exists = LUX }  }
				luxemburg_area = { 
					limit = { 
						NOT = { 
							OR = { 
								country_or_non_sovereign_subject_holds = ROOT 
								is_core = ROOT 
							}
						}
					}
					add_core = ROOT 
				}
			}
			if = { 
				limit = {
					exists = HAI
					NOT = { senior_union_with = HAI }
				}
				add_casus_belli = {
					target = HAI
					type = cb_restore_personal_union
					months = 480
				}
			}
			else_if = { 
				limit = { NOT = { exists = HAI }  }
				hainaut_area = { 
					limit = { 
						NOT = { 
							OR = { 
								country_or_non_sovereign_subject_holds = ROOT 
								is_core = ROOT 
							}
						}
					}
					add_core = ROOT 
				}
			}
			if = { 
				limit = {
					exists = BRB
					NOT = { senior_union_with = BRB }
				}
				add_casus_belli = {
					target = BRB
					type = cb_restore_personal_union
					months = 480
				}
			}
			else_if = { 
				limit = { NOT = { exists = BRB }  }
				brabant_area = { 
					limit = { 
						NOT = { 
							OR = { 
								country_or_non_sovereign_subject_holds = ROOT 
								is_core = ROOT 
							}
						}
					}
					add_core = ROOT 
				}
			}
			low_countries_region = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}
}
ai_spa_branch_1b = {
	slot = 1
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = SPA
			was_tag = SPA
			tag = SPN
		}
		was_tag = CAS
	}

	spa_low_countries = {
		icon = mission_spanish_netherlands
		position = 9
		required_missions = { spa_bur } 
		provinces_to_highlight = {
			region = low_countries_region
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
		}

		trigger = {
			num_of_owned_provinces_with = {
				region = low_countries_region
				value = 40
			}
		}

		effect = {
			add_country_modifier = {
				name = lc_trade_mod
				duration = -1
			}
		}
	}

	gc_spa_hre2 = {
		icon = mission_karl_i
		position = 10
		required_missions = {
			spa_low_countries
			spa_hre_ambition
			spa_flanders
		}
		provinces_to_highlight = {  
			OR = {
				area = artois_area
				area = flanders_area
				area = hainaut_area
				area = brabant_area
				area = luxemburg_area
				area = holland_area
				area = north_brabant_area
				area = frisia_area
				area = bourgogne_area
				area = lombardy_area
				area = naples_area
				area = abruzzo_area
				area = capitanate_area
				area = apulia_area
				area = calabria_area
				area = sicily_area
				area = corsica_sardinia_area
				province_id = 1863
				province_id = 134
				province_id = 266
			}
			NOT = { 
				OR = {
					province_id = 1743
					province_id = 2975
					province_id = 5019
					province_id = 193
					province_id = 3398
					province_id = 5112
					province_id = 5372
					province_id = 1931
					country_or_non_sovereign_subject_holds = ROOT
				}
			}
		} 

		trigger = {
			artois_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			flanders_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			hainaut_area = { 
				OR = { 
					country_or_non_sovereign_subject_holds = ROOT 
					province_id = 1743
				}
				type = all 
			}
			brabant_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			holland_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			north_brabant_area = { 
				OR = {
					country_or_non_sovereign_subject_holds = ROOT 
					province_id = 2975
					province_id = 5019
				} 
				type = all 
			}
			frisia_area  = { 
				OR = { 
					country_or_non_sovereign_subject_holds = ROOT 
					province_id = 1931
					province_id = 5372
				}
				type = all 
			}
			bourgogne_area = { 
				OR = { 
					country_or_non_sovereign_subject_holds = ROOT 
					province_id = 193
					province_id = 3398
				}
				type = all 
			}
			lombardy_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			naples_area = { 
				OR = {
					country_or_non_sovereign_subject_holds = ROOT 
					province_id = 5112
				}
				type = all 
			}
			abruzzo_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			capitanate_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			apulia_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			calabria_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			sicily_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			corsica_sardinia_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			1863 = { country_or_non_sovereign_subject_holds = ROOT  }
			134 = { country_or_non_sovereign_subject_holds = ROOT  }
			266 = { country_or_non_sovereign_subject_holds = ROOT  }
		}

		effect = {
			add_country_modifier = {
				name = "spa_universal_empire_modifier"
				duration = -1
			}
			add_prestige_or_monarch_power = { amount = 50 } 
			if = { 
				limit = { 
					AND = { 
						exists = ENG 
						NOT = { exists = GBR }
					}
				}
				add_casus_belli = {
					target = ENG
					type = cb_restore_personal_union
					months = 480
				}
			}
			else_if = { 
				limit = { 
					AND = { 
						exists = GBR 
						NOT = { exists = ENG }
					}
				}
				add_casus_belli = {
					target = GBR
					type = cb_restore_personal_union
					months = 480
				}
			}
			else = { 
				home_counties_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				wessex_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				east_anglia_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				east_midlands_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				west_midlands_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				wales_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				scottish_marches_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				yorkshire_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				northumberland_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
			}
		}
	}

	spa_eng = {
		icon = english_alliance
		position = 11
		required_missions = { gc_spa_hre2 } 
		provinces_to_highlight = {  
			OR = { 
				area = home_counties_area
				area = wessex_area
				area = east_anglia_area
				area = east_midlands_area
				area = west_midlands_area
				area = wales_area
				area = scottish_marches_area
				area = yorkshire_area
				area = northumberland_area
			}
		} 

		trigger = {  
			OR = { 
				senior_union_with = ENG 
				senior_union_with = GBR 
				AND = { 
					home_counties_area = { 
						country_or_non_sovereign_subject_holds = ROOT 
						type = all 
					}
					wessex_area = { 
						country_or_non_sovereign_subject_holds = ROOT 
						type = all 
					}
					east_anglia_area = { 
						country_or_non_sovereign_subject_holds = ROOT 
						type = all 
					}
					east_midlands_area = { 
						country_or_non_sovereign_subject_holds = ROOT 
						type = all 
					}
					west_midlands_area = { 
						country_or_non_sovereign_subject_holds = ROOT 
						type = all 
					}
					wales_area = { 
						country_or_non_sovereign_subject_holds = ROOT 
						type = all 
					}
					scottish_marches_area = { 
						country_or_non_sovereign_subject_holds = ROOT 
						type = all 
					}
					yorkshire_area = { 
						country_or_non_sovereign_subject_holds = ROOT 
						type = all 
					}
					northumberland_area = { 
						country_or_non_sovereign_subject_holds = ROOT 
						type = all 
					}
				}
			}
		} 

		effect = {  
			add_country_modifier = { 
				name = rule_britannia_spa
				duration = -1
			}
			british_isles_region = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}
}
ai_cas_locked_branch_1 = {
	slot = 1
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = CAS } 

	cas_locked_1f = {
		icon = mission_locked_mission
		position = 9
		required_missions = { spa_bur } 
		provinces_to_highlight = {
			region = low_countries_region
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			num_of_owned_provinces_with = {
				region = low_countries_region
				value = 40
			}
		}

		effect = {
			custom_tooltip = spa_unlock_mission.tt
			add_country_modifier = {
				name = lc_trade_mod
				duration = -1
			}
		}
	}

	cas_locked_1g = {
		icon = mission_locked_mission
		position = 10
		required_missions = {
			cas_locked_1f
			cas_locked_2f
			cas_locked_3f
		}
		provinces_to_highlight = {  
			OR = {
				area = artois_area
				area = flanders_area
				area = hainaut_area
				area = brabant_area
				area = luxemburg_area
				area = holland_area
				area = north_brabant_area
				area = frisia_area
				area = bourgogne_area
				area = lombardy_area
				area = naples_area
				area = abruzzo_area
				area = capitanate_area
				area = apulia_area
				area = calabria_area
				area = sicily_area
				area = corsica_sardinia_area
				province_id = 1863
				province_id = 134
				province_id = 266
			}
			NOT = { 
				OR = {
					province_id = 1743
					province_id = 2975
					province_id = 5019
					province_id = 193
					province_id = 3398
					province_id = 5112
					province_id = 5372
					province_id = 1931
					country_or_non_sovereign_subject_holds = ROOT
				}
			}
		} 

		trigger = {
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			artois_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			flanders_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			hainaut_area = { 
				OR = { 
					country_or_non_sovereign_subject_holds = ROOT 
					province_id = 1743
				}
				type = all 
			}
			brabant_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			holland_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			north_brabant_area = { 
				OR = {
					country_or_non_sovereign_subject_holds = ROOT 
					province_id = 2975
					province_id = 5019
				} 
				type = all 
			}
			frisia_area  = { 
				OR = { 
					country_or_non_sovereign_subject_holds = ROOT 
					province_id = 1931
					province_id = 5372
				}
				type = all 
			}
			bourgogne_area = { 
				OR = { 
					country_or_non_sovereign_subject_holds = ROOT 
					province_id = 193
					province_id = 3398
				}
				type = all 
			}
			lombardy_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			naples_area = { 
				OR = {
					country_or_non_sovereign_subject_holds = ROOT 
					province_id = 5112
				}
				type = all 
			}
			abruzzo_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			capitanate_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			apulia_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			calabria_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			sicily_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			corsica_sardinia_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			1863 = { country_or_non_sovereign_subject_holds = ROOT  }
			134 = { country_or_non_sovereign_subject_holds = ROOT  }
			266 = { country_or_non_sovereign_subject_holds = ROOT  }
		}

		effect = {
			custom_tooltip = spa_unlock_mission.tt
			add_country_modifier = {
				name = "spa_universal_empire_modifier"
				duration = -1
			}
			add_prestige_or_monarch_power = { amount = 50 } 
			if = { 
				limit = { 
					AND = { 
						exists = ENG 
						NOT = { exists = GBR }
					}
				}
				add_casus_belli = {
					target = ENG
					type = cb_restore_personal_union
					months = 480
				}
			}
			else_if = { 
				limit = { 
					AND = { 
						exists = GBR 
						NOT = { exists = ENG }
					}
				}
				add_casus_belli = {
					target = GBR
					type = cb_restore_personal_union
					months = 480
				}
			}
			else = { 
				home_counties_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				wessex_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				east_anglia_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				east_midlands_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				west_midlands_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				wales_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				scottish_marches_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				yorkshire_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				northumberland_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
			}
		}
	}

	cas_locked_1h = {
		icon = mission_locked_mission
		position = 11
		required_missions = { cas_locked_1g } 
		provinces_to_highlight = {  
			OR = { 
				area = home_counties_area
				area = wessex_area
				area = east_anglia_area
				area = east_midlands_area
				area = west_midlands_area
				area = wales_area
				area = scottish_marches_area
				area = yorkshire_area
				area = northumberland_area
			}
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			OR = { 
				senior_union_with = ENG 
				senior_union_with = GBR 
				AND = { 
					home_counties_area = { 
						country_or_non_sovereign_subject_holds = ROOT 
						type = all 
					}
					wessex_area = { 
						country_or_non_sovereign_subject_holds = ROOT 
						type = all 
					}
					east_anglia_area = { 
						country_or_non_sovereign_subject_holds = ROOT 
						type = all 
					}
					east_midlands_area = { 
						country_or_non_sovereign_subject_holds = ROOT 
						type = all 
					}
					west_midlands_area = { 
						country_or_non_sovereign_subject_holds = ROOT 
						type = all 
					}
					wales_area = { 
						country_or_non_sovereign_subject_holds = ROOT 
						type = all 
					}
					scottish_marches_area = { 
						country_or_non_sovereign_subject_holds = ROOT 
						type = all 
					}
					yorkshire_area = { 
						country_or_non_sovereign_subject_holds = ROOT 
						type = all 
					}
					northumberland_area = { 
						country_or_non_sovereign_subject_holds = ROOT 
						type = all 
					}
				}
			}
		} 

		effect = {  
			custom_tooltip = spa_unlock_mission.tt
			add_country_modifier = { 
				name = rule_britannia_spa
				duration = -1
			}
			british_isles_region = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}
}
ai_cas_branch_2 = {
	slot = 2
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = CAS
			was_tag = CAS
		}
	}

	spa_salamanca = {
		icon = mission_salamanco
		position = 2
		required_missions = { spa_vivero } 
		provinces_to_highlight = {
			province_id = 216
			NOT = {
				AND = {
					num_of_times_improved = 8
					has_production_building_trigger = yes
					renaissance = 100
				}
			}
		}

		trigger = {
			216 = {
				num_of_times_improved = 8
				has_production_building_trigger = yes
				renaissance = 100
			}
		}

		effect = {
			216 = {
				add_province_modifier = {
					name = "salamanca_real"
					duration = -1
				}
			}
		}
	}

	spa_santa_hermandad = {
		icon = reform_bergordnung
		position = 3
		required_missions = {
			spa_salamanca
			spa_isabelline
		}
		provinces_to_highlight = {  } 

		trigger = {  
			stability = 2
			papal_influence = 20
			adm_power = 200
		} 

		effect = {  
			add_papal_influence = -20
			add_adm_power = -200
			add_government_reform = hermandad_reform
		} 
	}

	spa_annex_orders = {
		icon = mission_calatrava
		position = 4
		required_missions = {
			spa_santa_hermandad
			gc_cas_spa_reconquista_one2
		}
		provinces_to_highlight = {  } 

		trigger = {  
			OR = { 
				is_papal_controller = yes
				is_previous_papal_controller = yes 
			}
			papal_influence = 50
			adm = 5
		} 

		effect = {  
			add_papal_influence = -50
			custom_tooltip = spa_remove_orders.tt
			hidden_effect = { 
				every_province = { 
					limit = { has_province_modifier = santiago_mod }
					remove_province_modifier = santiago_mod
				}
				every_province = { 
					limit = { has_province_modifier = alcantara_mod }
					remove_province_modifier = alcantara_mod
				}
				every_province = { 
					limit = { has_active_triggered_province_modifier = stj_order }
					remove_province_triggered_modifier = stj_order
				}
				every_province = { 
					limit = { has_province_modifier = calatrava_mod }
					remove_province_modifier = calatrava_mod
				}
				set_country_flag = enable_spa_orders_flag
			}
		} 
	}

	spa_cont_rec = {
		icon = mission_break_sicily
		position = 5
		required_missions = { spa_alhambra_decree } 
		provinces_to_highlight = {
			OR = {
				#morocco
				province_id = 5741
				province_id = 347
				province_id = 5719
				province_id = 1751
				province_id = 5715
				province_id = 335
				#tlemcen
				province_id = 5763
				province_id = 4562
				province_id = 337
				province_id = 338
				province_id = 1882
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
		}

		trigger = {  
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				OR = {
					#morocco
					province_id = 5741
					province_id = 347
					province_id = 5719
					province_id = 1751
					province_id = 5715
					province_id = 335
					#tlemcen
					province_id = 5763
					province_id = 4562
					province_id = 337
					province_id = 338
					province_id = 1882
				}
				value = 7
			}
		} 

		effect = {
			add_country_modifier = { 
				name = spa_barbary_counter
				duration = 18250
			}
			341 = { add_permanent_claim = ROOT } 
			2473 = { add_permanent_claim = ROOT } 
			5819 = { add_permanent_claim = ROOT } 
			5818 = { add_permanent_claim = ROOT } 
			2954 = { add_permanent_claim = ROOT } 
			354 = { add_permanent_claim = ROOT } 
		}
	}

	spa_tunis = {
		icon = mission_patronize_art_and_religion
		position = 6
		required_missions = { spa_cont_rec } 
		provinces_to_highlight = {
			province_id = 341
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
		}

		trigger = { owns = 341 } 

		effect = {
			add_country_modifier = {
				name = "spa_expand_coast"
				duration = -1
			}
			tunisia_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			byzancena_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			djerba_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			numidia_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		}
	}
}
ai_spa_branch_2 = {
	slot = 2
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = SPA
			was_tag = SPA
			tag = SPN
		}
		was_tag = CAS
	}

	spa_tercios_system = {
		icon = spa_tercios_system
		position = 7
		provinces_to_highlight = {  } 

		trigger = {
			num_of_owned_provinces_with = {
				has_manpower_building_trigger = yes
				value = 15
			}
			reform_level = 4
			NOT = { current_age = age_of_discovery } 
		}

		effect = {
			set_country_flag = enable_tercios_reform_flag
			add_government_reform = tercios_reform
			if = {
				limit = { has_dlc = "Cradle of Civilization" } 
				add_army_professionalism = 0.05
			}
			else = { add_army_tradition = 10 } 
		}
	}

	spa_reform_tercios = {
		icon = spa_reform_tercios
		position = 8
		required_missions = { spa_tercios_system } 
		provinces_to_highlight = {  } 

		trigger = {
			num_of_tercio = 60
			OR = {
				army_professionalism = 0.75
				army_tradition = 90
			}
		}

		effect = {
			add_country_modifier = {
				name = "spa_reformed_tercio_modifier"
				duration = -1
			}
			if = {
				limit = {
					has_dlc = "Rights of Man"
					NOT = { num_of_ruler_traits = { amount = 3 }  } 
				}
				add_ruler_personality = strict_personality
			}
			else = {
				change_ruler_stat = {
					type = mil
					amount = 2
				}
			}
		}
	}

	spa_flanders = {
		icon = mission_great_council_bur
		position = 9
		required_missions = { spa_bur } 
		provinces_to_highlight = {  
			OR = { 
				province_id = 90
				province_id = 92
				province_id = 1744
			}
			NOT = { 
				AND = { 
					owned_by = ROOT 
					is_core = ROOT 
					has_building = courthouse
					num_of_times_improved = 5
				}
			}
		} 

		trigger = {  
			90 = { 
				owned_by = ROOT 
				is_core = ROOT 
				religion = ROOT
				has_building = courthouse
				num_of_times_improved = 5
			}
			92 = { 
				owned_by = ROOT 
				is_core = ROOT 
				religion = ROOT
				has_building = courthouse
				num_of_times_improved = 5
			}
			1744 = { 
				owned_by = ROOT 
				is_core = ROOT 
				religion = ROOT 
				has_building = courthouse
				num_of_times_improved = 5
			}
			accepted_culture = flemish 
			accepted_culture = brabantian
		} 

		effect = {  
			if = { 
				limit = { has_dlc = "Domination" }
				custom_tooltip = new_lc_council.tt
				hidden_effect = { set_country_flag = flanders_council_flag }
			}
			else = { 
				add_country_modifier = {
					name = "lc_council"
					duration = -1
				}
			}
		} 
	}

	spa_hre_heretics = {
		icon = chivalry_is_not_dead
		position = 10
		required_missions = { spa_hre_ambition } 
		provinces_to_highlight = {
			is_part_of_hre = yes
			is_capital = yes
			owner = {
				OR = {
					religion = protestant
					religion = reformed
				}
			}
		}

		trigger = {
			hre_religion = catholic
			hre_religion_locked = yes
			hre_religion_treaty = yes
		}

		effect = {
			add_country_modifier = {
				name = "catholic_empire_spa"
				duration = -1
			}
		}
	}
}
ai_cas_locked_branch_2 = {
	slot = 2
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = CAS } 

	cas_locked_2d = {
		icon = mission_locked_mission
		position = 7
		provinces_to_highlight = {  } 

		trigger = {
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			num_of_owned_provinces_with = {
				has_manpower_building_trigger = yes
				value = 15
			}
			reform_level = 4
			NOT = { current_age = age_of_discovery } 
		}

		effect = {
			custom_tooltip = spa_unlock_mission.tt 
			set_country_flag = enable_tercios_reform_flag
			add_government_reform = tercios_reform
			if = {
				limit = { has_dlc = "Cradle of Civilization" } 
				add_army_professionalism = 0.05
			}
			else = { add_army_tradition = 10 } 
		}
	}

	cas_locked_2e = {
		icon = mission_locked_mission
		position = 8
		required_missions = { cas_locked_2d } 
		trigger = {
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			num_of_tercio = 60
			OR = {
				army_professionalism = 0.75
				army_tradition = 90
			}
		}

		effect = {
			custom_tooltip = spa_unlock_mission.tt
			add_country_modifier = {
				name = "spa_reformed_tercio_modifier"
				duration = -1
			}
			if = {
				limit = {
					has_dlc = "Rights of Man"
					NOT = { num_of_ruler_traits = { amount = 3 }  } 
				}
				add_ruler_personality = strict_personality
			}
			else = {
				change_ruler_stat = {
					type = mil
					amount = 2
				}
			}
		}
	}

	cas_locked_2f = {
		icon = mission_locked_mission
		position = 9
		required_missions = { spa_bur } 
		provinces_to_highlight = {  
			OR = { 
				province_id = 90
				province_id = 92
				province_id = 1744
			}
			NOT = { 
				AND = { 
					owned_by = ROOT 
					is_core = ROOT 
					has_building = courthouse
					num_of_times_improved = 5
				}
			}
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			90 = { 
				owned_by = ROOT 
				is_core = ROOT 
				religion = ROOT
				has_building = courthouse
				num_of_times_improved = 5
			}
			92 = { 
				owned_by = ROOT 
				is_core = ROOT 
				religion = ROOT
				has_building = courthouse
				num_of_times_improved = 5
			}
			1744 = { 
				owned_by = ROOT 
				is_core = ROOT 
				religion = ROOT 
				has_building = courthouse
				num_of_times_improved = 5
			}
			accepted_culture = flemish 
			accepted_culture = brabantian
		} 

		effect = {  
			custom_tooltip = spa_unlock_mission.tt
			if = { 
				limit = { has_dlc = "Domination" }
				custom_tooltip = new_lc_council.tt
				hidden_effect = { set_country_flag = flanders_council_flag }
			}
			else = { 
				add_country_modifier = {
					name = "lc_council"
					duration = -1
				}
			}
		} 
	}

	cas_locked_2g = {
		icon = mission_locked_mission
		position = 10
		required_missions = { cas_locked_3f } 
		provinces_to_highlight = {
			is_part_of_hre = yes
			is_capital = yes
			owner = {
				OR = {
					religion = protestant
					religion = reformed
				}
			}
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			hre_religion = catholic
			hre_religion_locked = yes
			hre_religion_treaty = yes
		}

		effect = {
			custom_tooltip = spa_unlock_mission.tt
			add_country_modifier = {
				name = "catholic_empire_spa"
				duration = -1
			}
		}
	}
}
ai_cas_branch_3 = {
	slot = 3
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = CAS
			was_tag = CAS
		}
	}

	spa_segovia = {
		icon = mission_alcazar
		position = 1
		provinces_to_highlight = {
			province_id = 4789
			NOT = {
				AND = {
					is_capital = yes
					num_of_times_improved = 8
					has_tax_building_trigger = yes
					has_trade_building_trigger = yes
				}
			}
		}

		trigger = {
			4789 = {
				is_capital = yes
				num_of_times_improved = 8
				has_tax_building_trigger = yes
				has_trade_building_trigger = yes
			}
		}

		effect = {
			4789 = {
				add_great_project_tier = {
					type = ai_segovia
					tier = 1
				}
				add_province_modifier = {
					name = "segovia_real"
					duration = -1
				}
			}
		}
	}

	spa_cortes_representation = {
		icon = mission_restore_faith_in_the_throne
		position = 2
		required_missions = {
			spa_vivero
			spa_segovia
		}
		provinces_to_highlight = {  
			OR = { 
				province_id = 215 #valladolid
				province_id = 217 #madrid
				province_id = 4971 #medina del campo
				province_id = 4949 #Guadalajara
				province_id = 4553 #zamora
				province_id = 1746 #burgos
				province_id = 216 #salamanca
				province_id = 219 #toledo
				province_id = 4789 #segovia
			}
			NOT = { has_province_flag = cas_capital_location_flag }
		} 

		trigger = {  
			custom_trigger_tooltip = { 
				tooltip = 215_cas_capital.tt
				215 = { has_province_flag = cas_capital_location_flag }
			}
			custom_trigger_tooltip = { 
				tooltip = 217_cas_capital.tt
				217 = { has_province_flag = cas_capital_location_flag }
			}
			custom_trigger_tooltip = { 
				tooltip = 4971_cas_capital.tt
				4971 = { has_province_flag = cas_capital_location_flag }
			}
			custom_trigger_tooltip = { 
				tooltip = 4949_cas_capital.tt
				4949 = { has_province_flag = cas_capital_location_flag }
			}
			custom_trigger_tooltip = { 
				tooltip = 4553_cas_capital.tt
				4553 = { has_province_flag = cas_capital_location_flag }
			}
			custom_trigger_tooltip = { 
				tooltip = 1746_cas_capital.tt
				1746 = { has_province_flag = cas_capital_location_flag }
			}
			custom_trigger_tooltip = { 
				tooltip = 216_cas_capital.tt
				216 = { has_province_flag = cas_capital_location_flag }
			}
			custom_trigger_tooltip = { 
				tooltip = 219_cas_capital.tt
				219 = { has_province_flag = cas_capital_location_flag }
			}
			custom_trigger_tooltip = { 
				tooltip = 4789_cas_capital.tt
				4789 = { has_province_flag = cas_capital_location_flag }
			}
		} 

		effect = {  
			custom_tooltip = cas_capital_mod.tt
			hidden_effect = { 
				215 = { 
					add_province_modifier = { 
						name = cas_cortes_mod
						duration = -1
					}
				}
				217 = { 
					add_province_modifier = { 
						name = cas_cortes_mod
						duration = -1
					}
				}
				4971 = { 
					add_province_modifier = { 
						name = cas_cortes_mod
						duration = -1
					}
				}
				4949 = { 
					add_province_modifier = { 
						name = cas_cortes_mod
						duration = -1
					}
				}
				4553 = { 
					add_province_modifier = { 
						name = cas_cortes_mod
						duration = -1
					}
				}
				1746 = { 
					add_province_modifier = { 
						name = cas_cortes_mod
						duration = -1
					}
				}
				216 = { 
					add_province_modifier = { 
						name = cas_cortes_mod
						duration = -1
					}
				}
				219 = { 
					add_province_modifier = { 
						name = cas_cortes_mod
						duration = -1
					}
				}
				4789 = { 
					add_province_modifier = { 
						name = cas_cortes_mod
						duration = -1
					}
				}
			}
		} 
	}

	gc_cas_spa_reconquista_one2 = {
		icon = mission_granada
		position = 3
		required_missions = { spa_isabelline } 
		provinces_to_highlight = {
			area = granada_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
		}

		trigger = {
			granada_area = {
				country_or_non_sovereign_subject_holds = ROOT
				type = all
			}
		}

		effect = {
			add_country_modifier = { 
				name = cas_gra_finished
				duration = 18250
			}
		}
	}

	spa_alhambra_decree = {
		icon = standardize_relazioni
		position = 4
		required_missions = { gc_cas_spa_reconquista_one2 } 
		provinces_to_highlight = {  
			province_id = 223
			NOT = { 
				AND = { 
					owned_by = ROOT
					is_core = ROOT 
					is_capital = yes
				}
			}
		} 

		trigger = {
			owns_core_province = 223
			223 = { is_capital = yes }
		}

		effect = {
			set_country_flag = fate_of_granada_mission_flag
			country_event = { id = aetas_cas.14 } 
			1751 = { add_permanent_claim = ROOT } 
			335 = { add_permanent_claim = ROOT } 
			5763 = { add_permanent_claim = ROOT } 
			4562 = { add_permanent_claim = ROOT } 
			337 = { add_permanent_claim = ROOT } 
			338 = { add_permanent_claim = ROOT } 
			1882 = { add_permanent_claim = ROOT } 
		}
	}

	spa_revoke_granada = {
		icon = mission_turning_the_tables
		position = 5
		required_missions = { spa_alhambra_decree } 
		provinces_to_highlight = {  
			OR = { 
				area = granada_area
				area = murcia_area
			}
			religion = sunni 
		} 

		trigger = {  
			granada_area = {
				religion = ROOT 
				type = all 
			}
			murcia_area = { 
				religion = ROOT 
				type = all 
			}
		} 

		effect = {  
			add_stability = 1
			add_country_modifier = { 
				name = spa_inquisition_mod
				duration = 18250
			}
		} 
	}
}
ai_spa_branch_3 = {
	slot = 3
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = SPA
			was_tag = SPA
			tag = SPN
		}
		was_tag = CAS
	}

	spa_moriscos = {
		icon = mission_hands_praying
		position = 6
		required_missions = { spa_revoke_granada } 
		provinces_to_highlight = {  
			country_or_non_sovereign_subject_holds = ROOT 
			OR = { 
				culture = mudejar 
				culture = morisco 
			}
		} 

		trigger = {  
			OR = { 
				AND = { 
					has_idea_group = humanist_ideas
					accepted_culture = morisco
					accepted_culture = mudejar 
				}
				AND = { 
					has_idea_group = religious_ideas 
					granada_area = { 
						culture_group = ROOT 
						NOT = { 
							OR = { 
								culture = morisco
								culture = mudejar
							}
						}
					}
				}
			}
		} 

		effect = {  
			add_country_modifier = { 
				name = spa_culture_mod
				duration = -1
			}
		} 
	}

	spa_castilianization = {
		icon = mission_book_of_royal_degrees
		position = 7
		required_missions = { spa_moriscos } 
		provinces_to_highlight = {  
			owned_by = ROOT 
			OR = { 
				culture = aragonese
				culture = leonese
			}
		} 

		trigger = {  
			num_of_owned_provinces_with = { 
				area = leon_area
				culture = castillian 
				value = 7
			}
			num_of_owned_provinces_with = { 
				area = extremadura_area
				culture = castillian 
				value = 6
			}
			num_of_owned_provinces_with = { 
				area = aragon_area
				culture = castillian 
				value = 7
			}
		} 

		effect = {  
			add_country_modifier = { 
				name = cas_unity
				duration = 18250
			}
		} 
	}

	spa_hre_ambition = {
		icon = mission_alfonso_x
		position = 9
		required_missions = { spa_bur } 
		provinces_to_highlight = {  } 

		trigger = { is_emperor = yes } 

		effect = {  
			add_country_modifier = { 
				name = fecho_del_impero
				duration = -1
			}
		} 
	}

	spa_nueva_planta = {
		icon = mission_felipe_v
		position = 8
		required_missions = { spa_castilianization } 
		provinces_to_highlight = {  } 

		trigger = {  
			absolutism = 25
			reform_level = 10
			current_age = age_of_absolutism
		} 

		effect = { add_government_reform = nueva_planta_decrees_reform } 
	}
}
ai_cas_locked_branch_3 = {
	slot = 3
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = CAS } 

	cas_locked_3c = {
		icon = mission_locked_mission
		position = 6
		required_missions = { spa_revoke_granada } 
		provinces_to_highlight = {  
			country_or_non_sovereign_subject_holds = ROOT 
			OR = { 
				culture = mudejar 
				culture = morisco 
			}
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			OR = { 
				AND = { 
					has_idea_group = humanist_ideas
					accepted_culture = morisco
					accepted_culture = mudejar 
				}
				AND = { 
					has_idea_group = religious_ideas 
					granada_area = { 
						culture_group = ROOT 
						NOT = { 
							OR = { 
								culture = morisco
								culture = mudejar
							}
						}
					}
				}
			}
		} 

		effect = {  
			custom_tooltip = spa_unlock_mission.tt
			add_country_modifier = { 
				name = spa_culture_mod
				duration = -1
			}
		} 
	}

	cas_locked_3d = {
		icon = mission_locked_mission
		position = 7
		required_missions = { cas_locked_3c } 
		provinces_to_highlight = {  
			owned_by = ROOT 
			OR = { 
				culture = aragonese
				culture = leonese
			}
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			num_of_owned_provinces_with = { 
				area = leon_area
				culture = castillian 
				value = 7
			}
			num_of_owned_provinces_with = { 
				area = extremadura_area
				culture = castillian 
				value = 6
			}
			num_of_owned_provinces_with = { 
				area = aragon_area
				culture = castillian 
				value = 7
			}
		} 

		effect = {  
			custom_tooltip = spa_unlock_mission.tt
			add_country_modifier = { 
				name = cas_unity
				duration = 18250
			}
		}  
	}

	cas_locked_3e = {
		icon = mission_locked_mission
		position = 8
		required_missions = { cas_locked_3d } 

		trigger = { 
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			is_emperor = yes 
		} 

		effect = {  
			custom_tooltip = spa_unlock_mission.tt
			add_country_modifier = { 
				name = fecho_del_impero
				duration = -1
			}
		} 
	}

	cas_locked_3f = {
		icon = mission_locked_mission
		position = 9
		required_missions = { spa_bur } 
		
		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			absolutism = 25
			reform_level = 10
			current_age = age_of_absolutism
		} 

		effect = { 
			custom_tooltip = spa_unlock_mission.tt
			add_government_reform = nueva_planta_decrees_reform 
		} 
	}
}
ai_cas_branch_3b = {
	slot = 3
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = CAS
			was_tag = CAS
		}
	}

	spa_tenerife = {
		icon = crusader_fleet
		position = 11
		required_missions = { spa_cae_roc } 
		provinces_to_highlight = {  
			province_id = 4565
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			4565 = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		effect = {  
			add_prestige_or_monarch_power = { amount = 15 }
		}  
	}

	spa_cae_fortune = {
		icon = mission_wine_monopolies
		position = 12
		required_missions = {
			spa_tenerife
			spa_canaria
		}
		provinces_to_highlight = {  
			OR = { 
				province_id = 366
				province_id = 4565
			}
			NOT = { 
				AND = { 
					country_or_non_sovereign_subject_holds = ROOT 
					trade_goods = sugar
					has_production_building_trigger = yes 
				}
			}
		} 

		trigger = {  
			366 = { 
				country_or_non_sovereign_subject_holds = ROOT 
				trade_goods = sugar
				has_production_building_trigger = yes 
			}
			4565 = { 
				country_or_non_sovereign_subject_holds = ROOT 
				trade_goods = sugar
				has_production_building_trigger = yes 
			}
		} 

		effect = {  
			366 = { add_building = plantations }
			4565 = { add_building = plantations }
		} 
	}
}
ai_cas_branch_4 = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = CAS
			was_tag = CAS
		}
	}

	spa_isabelline = {
		icon = mission_isabella
		position = 2
		required_missions = { spa_infantes_aragon } 
		provinces_to_highlight = {  } 

		trigger = {
			custom_trigger_tooltip = {
				tooltip = chose_isabel
				has_country_flag = isabel_heir
			}
			has_ruler = "Isabel I"
		}

		effect = {
			add_ruler_modifier = {
				name = "isabelline"
				duration = -1
			}
		}
	}

	spa_iberian_wedding = {
		icon = mission_reyes_catolicos
		position = 3
		required_missions = {
			spa_isabelline
			cas_ara_relations
		}
		provinces_to_highlight = {  } 

		trigger = { ARA = { junior_union_with = ROOT }  } 

		effect = {
			add_ruler_modifier = {
				name = "catholic_monarchs"
				duration = -1
			}
			basque_country = {
				add_core = ARA
			}
		}
	}
}
ai_spa_branch_4a = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = SPA
			was_tag = SPA
			tag = SPN
		}
		was_tag = CAS
	}

	spa_councils = {
		icon = hispanic_monarchy
		position = 4
		required_missions = { spa_iberian_wedding } 
		provinces_to_highlight = {  } 

		trigger = {  
			OR = { 
				tag = SPA 
				tag = SPN 
			}
			stability = 2
			legitimacy = 100 
		} 

		effect = { 
			add_government_reform = hispanic_monarchy_reform 
			corsica_sardinia_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			sicily_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}

	spa_ara_isles = {
		icon = mission_seize_the_isles
		position = 5
		required_missions = { spa_councils } 
		provinces_to_highlight = {  
			OR = { 
				area = corsica_sardinia_area
				area = sicily_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			corsica_sardinia_area = { 
				country_or_non_sovereign_subject_holds = ROOT
				type = all 
			}
			sicily_area = { 
				country_or_non_sovereign_subject_holds = ROOT
				type = all 
			}
		} 

		effect = {  
			add_casus_belli = {
				target = NAP
				type = cb_restore_personal_union
				months = 480
			}
			naples_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			calabria_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			apulia_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			capitanate_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			abruzzo_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}

	spa_naples = {
		icon = union_with_naples
		position = 6
		required_missions = { spa_ara_isles } 
		provinces_to_highlight = {
			OR = {
				owned_by = NAP
				area = naples_area
				area = calabria_area
				area = capitanate_area
				area = abruzzo_area
				area = apulia_area
			}
			NOT = { province_id = 5112 } 
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
		}

		trigger = {
			OR = {
				NAP = { junior_union_with = ROOT } 
				AND = {
					naples_area = {
						country_or_non_sovereign_subject_holds = ROOT
						NOT = { province_id = 5112 } 
						type = all
					}
					calabria_area = {
						country_or_non_sovereign_subject_holds = ROOT
						type = all
					}
					capitanate_area = {
						country_or_non_sovereign_subject_holds = ROOT
						type = all
					}
					abruzzo_area = {
						country_or_non_sovereign_subject_holds = ROOT
						type = all
					}
					apulia_area = {
						country_or_non_sovereign_subject_holds = ROOT
						type = all
					}
				}
			}
		}

		effect = {
			add_country_modifier = {
				name = "crown_of_naples"
				duration = -1
			}
			if = { 
				limit = { exists = MLO }
				add_casus_belli = {
					target = MLO
					type = cb_restore_personal_union
					months = 480
				}
			}
			lombardy_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			5073 = { add_permanent_claim = ROOT }
		}
	}

	spa_milan = {
		icon = seize_lombardy
		position = 7
		required_missions = { spa_naples } 
		provinces_to_highlight = {
			area = lombardy_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
		}

		trigger = {
			lombardy_area = {
				country_or_non_sovereign_subject_holds = ROOT
				type = all
			}
		}

		effect = {
			add_accepted_culture = lombard
			add_country_modifier = {
				name = "lombard_spa"
				duration = -1
			}
		}
	}

	spa_presidios = {
		icon = the_russian_campaign
		position = 8
		required_missions = { spa_milan } 
		provinces_to_highlight = {  
			province_id = 5073
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			5073 = { 
				country_or_non_sovereign_subject_holds = ROOT 
				has_manpower_building_trigger = yes 
				has_fort_building_trigger = yes 
			}
		} 

		effect = {  
			5073 = { 
				add_province_modifier = { 
					name = los_presidios_mod
					duration = -1
				}
			}
			tuscany_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			south_tuscany_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}
}
ai_cas_locked_branch_4 = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = CAS } 

	cas_locked_4a = {
		icon = mission_locked_mission
		position = 4
		required_missions = { spa_iberian_wedding } 
		provinces_to_highlight = {  } 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			OR = { 
				tag = SPA 
				tag = SPN 
			}
			stability = 2
			legitimacy = 100 
		} 

		effect = { 
			custom_tooltip = spa_unlock_mission.tt
			add_government_reform = hispanic_monarchy_reform 
			corsica_sardinia_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			sicily_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}

	cas_locked_4b = {
		icon = mission_locked_mission
		position = 5
		required_missions = { cas_locked_4a } 
		provinces_to_highlight = {  
			OR = { 
				area = corsica_sardinia_area
				area = sicily_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			corsica_sardinia_area = { 
				country_or_non_sovereign_subject_holds = ROOT
				type = all 
			}
			sicily_area = { 
				country_or_non_sovereign_subject_holds = ROOT
				type = all 
			}
		} 

		effect = {  
			custom_tooltip = spa_unlock_mission.tt
			add_casus_belli = {
				target = NAP
				type = cb_restore_personal_union
				months = 480
			}
			naples_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			calabria_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			apulia_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			capitanate_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			abruzzo_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}

	cas_locked_4c = {
		icon = mission_locked_mission
		position = 6
		required_missions = { cas_locked_4b } 
		provinces_to_highlight = {
			OR = {
				owned_by = NAP
				area = naples_area
				area = calabria_area
				area = capitanate_area
				area = abruzzo_area
				area = apulia_area
			}
			NOT = { province_id = 5112 } 
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			OR = {
				NAP = { junior_union_with = ROOT } 
				AND = {
					naples_area = {
						country_or_non_sovereign_subject_holds = ROOT
						NOT = { province_id = 5112 } 
						type = all
					}
					calabria_area = {
						country_or_non_sovereign_subject_holds = ROOT
						type = all
					}
					capitanate_area = {
						country_or_non_sovereign_subject_holds = ROOT
						type = all
					}
					abruzzo_area = {
						country_or_non_sovereign_subject_holds = ROOT
						type = all
					}
					apulia_area = {
						country_or_non_sovereign_subject_holds = ROOT
						type = all
					}
				}
			}
		}

		effect = {
			custom_tooltip = spa_unlock_mission.tt
			add_country_modifier = {
				name = "crown_of_naples"
				duration = -1
			}
			if = { 
				limit = { exists = MLO }
				add_casus_belli = {
					target = MLO
					type = cb_restore_personal_union
					months = 480
				}
			}
			lombardy_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			5073 = { add_permanent_claim = ROOT }
		}
	}

	cas_locked_4d = {
		icon = mission_locked_mission
		position = 7
		required_missions = { cas_locked_4c } 
		provinces_to_highlight = {
			area = lombardy_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			lombardy_area = {
				country_or_non_sovereign_subject_holds = ROOT
				type = all
			}
		}

		effect = {
			custom_tooltip = spa_unlock_mission.tt
			add_accepted_culture = lombard
			add_country_modifier = {
				name = "lombard_spa"
				duration = -1
			}
		}
	}

	cas_locked_4e = {
		icon = mission_locked_mission
		position = 8
		required_missions = { cas_locked_4d } 
		provinces_to_highlight = {  
			province_id = 5073
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			5073 = { 
				country_or_non_sovereign_subject_holds = ROOT 
				has_manpower_building_trigger = yes 
				has_fort_building_trigger = yes 
			}
		} 

		effect = {  
			custom_tooltip = spa_unlock_mission.tt
			5073 = { 
				add_province_modifier = { 
					name = los_presidios_mod
					duration = -1
				}
			}
			tuscany_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			south_tuscany_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}
}
ai_cas_branch_4b = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { 
		OR = {
			tag = CAS 
			tag = SPA
			tag = SPN
		}
	} 

	spa_norman_cae = {
		icon = mission_bethencourt
		position = 9
		provinces_to_highlight = { owned_by = CAE } 

		trigger = {  
			custom_trigger_tooltip = { 
				tooltip = cae_happened.tt #missing loc
				has_global_flag = cae_event_flag 
			}
		} 

		effect = {  
			if = { 
				limit = { has_global_flag = niebla_canaries }
				5711 = { add_core = CNR }
			}
			else_if = { 
				limit = { has_global_flag = castilian_canaries }
				5711 = { add_core = ROOT } 
			}
			else = { 
				5709 = { add_core = ROOT }
				5710 = { add_core = ROOT }
			}
		} 
	}

	spa_cae_roc = {
		icon = adjust_the_general_means
		position = 10
		required_missions = {
			spa_norman_cae
			cas_navy
		}
		provinces_to_highlight = {  } 

		trigger = {  
			OR = { 
				custom_trigger_tooltip = { 
					tooltip = cnr_sold_rights.tt
					has_global_flag = roc_sold_flag
				}
				AND = { 
					owns_core_province = 5709
					owns_core_province = 5710
				}
			}
		} 

		effect = {  
			add_country_modifier = { 
				name = cae_conquest_mod
				duration = 7300
			}
		} 
	}

	spa_canaria = {
		icon = colonize_the_cape
		position = 11
		required_missions = { spa_cae_roc } 
		provinces_to_highlight = {  
			province_id = 366
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			owns_core_province = 366
		} 

		effect = {  
			366 = { add_base_tax = 2 }
		} 
	}

	spa_royal_cae = {
		icon = mission_claim_the_canaries
		position = 12
		required_missions = {
			spa_tenerife
			spa_canaria
		}
		provinces_to_highlight = {  
			OR = { 
				province_id = 5709
				province_id = 5710
				province_id = 366
				province_id = 4565
				province_id = 5711
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			5709 = { country_or_non_sovereign_subject_holds = ROOT }
			5710 = { country_or_non_sovereign_subject_holds = ROOT }
			366 = { country_or_non_sovereign_subject_holds = ROOT }
			4565 = { country_or_non_sovereign_subject_holds = ROOT }
			5711 = { country_or_non_sovereign_subject_holds = ROOT }
			num_of_owned_provinces_with = {
				area = macaronesia_area
				value = 2
			}
		} 

		effect = {  
			custom_tooltip = inherit_cnr.tt
			hidden_effect = { 
				every_province = { 
					limit = { 
						area = macaronesia_area
						country_or_non_sovereign_subject_holds = ROOT 
						NOT = { owned_by = ROOT }
					}
					cede_province = ROOT 
					add_core = ROOT 
				}
			}
			add_country_modifier = { 
				name = cas_cae_mod
				duration = -1
			}
		} 
	}
}
ai_cas_branch_5 = {
	slot = 5
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { 
		OR = {
			tag = CAS 
			tag = SPA
			tag = SPN
		}
	} 

	spa_infantes_aragon = {
		icon = spa_infantes_aragon
		position = 1
		required_missions = {
		}
		provinces_to_highlight = {  
			OR = { 
				exists = PNF 
				exists = ABQ
			}
		} 

		trigger = {
			NOT = { 
				AND = {
					exists = PNF
					exists = ABQ 
					has_estate_privilege = estate_nobles_factionalist_nobility
				}
			}
		}

		effect = {
			change_ruler_stat = {
				type = adm
				amount = 1
			}
		}
	}

	cas_ara_relations = {
		icon = mission_chuan_ii
		position = 2
		required_missions = { spa_infantes_aragon } 
		provinces_to_highlight = { is_capital_of = ARA } 

		trigger = {
			OR = {
				alliance_with = ARA
				is_rival = ARA
			}
		}

		effect = { 
			add_prestige = 10 
			if = {
				limit = {
					exists = ARA
					valid_for_personal_unions_trigger = yes
					ARA = { valid_for_personal_unions_trigger = yes } 
				}
				add_casus_belli = {
					type = cb_restore_personal_union
					months = 300
					target = ARA
				}
			}
		} 
	}

	spa_navarre = {
		icon = mission_subjugate_navarra
		position = 3
		required_missions = { cas_ara_relations } 
		provinces_to_highlight = {
			area = basque_country
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
		}

		trigger = {
			basque_country = {
				country_or_non_sovereign_subject_holds = ROOT
				type = all
			}
		}

		effect = {
			add_prestige_or_monarch_power = { amount = 15 }
		}
	}
}
ai_spa_branch_5 = {
	slot = 5
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = SPA
			was_tag = SPA
			tag = SPN
		}
		was_tag = CAS
	}

	iberian_union = {
		icon = mission_lisboa
		position = 4
		required_missions = {
			spa_iberian_wedding
			spa_navarre
		}
		provinces_to_highlight = {  
			OR = { 
				area = trasosmontes_area
				area = beieras_area
				area = estremadura_area
				area = alentejo_area
				area = algarve_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {   
			trasosmontes_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			beieras_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			estremadura_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			alentejo_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			algarve_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
		} 

		effect = {
			custom_tooltip = new_por_council.tt
			set_country_flag = portugal_council_flag
		}
	}

	spa_gen_partnership = {
		icon = fra_restore_signoria
		position = 5
		required_missions = { spa_councils } 
		provinces_to_highlight = {  
			is_capital_of = GEN
		} 

		trigger = {  
			OR = { 
				AND = { 
					OR = { 
						alliance_with = GEN 
						GEN = { is_subject_of = ROOT }
					}
					GEN = { 
						has_opinion = { 
							who = ROOT 
							value = 200 
						}
						owns_core_province = 101
					}
				}
				AND = { 
					NOT = { exists = GEN }
					owns_core_province = 101
				}
			}
		} 

		effect = {  
			custom_tooltip = genoese_banks_reform.tt
			set_country_flag = enable_gen_banks_flag
		} 
	}

	spa_kni = {
		icon = mission_kni_malta
		position = 6
		required_missions = { spa_ara_isles } 
		provinces_to_highlight = {  
			province_id = 126
			NOT = { owned_by = KNI }
		} 

		trigger = {  
			126 = { country_or_non_sovereign_subject_holds = ROOT }
			is_year = 1530
			NOT = { exists = KNI }
			custom_trigger_tooltip = { 
				tooltip = kni_koj.tt
				all_country = { 
					NOT = { has_country_flag = knights_formed_jerusalem }
				}
			}
			NOT = { 
				OR = {
					320 = { country_or_non_sovereign_subject_holds = ROOT }
					5678 = { country_or_non_sovereign_subject_holds = ROOT }
				}
			}
		} 

		effect = { country_event = { id = flavor_kni.100 } } 
	}

	spa_tripoli = {
		icon = support_the_orders
		position = 7
		required_missions = { spa_kni } 
		provinces_to_highlight = {  
			province_id = 354
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = { 354 = { country_or_non_sovereign_subject_holds = ROOT } } 

		effect = {  
			custom_tooltip = kni_tripoli.tt
			hidden_effect = { 
				if = { 
					limit = {
						354 = { 
							country_or_non_sovereign_subject_holds = ROOT 
							owned_by = KNI 
						}
					}
					354 = { 
						add_province_modifier = { 
							name = kni_trp_mod #missing loc
							duration = -1
						}
					}
				}
			}
		} 
	}

	spa_council_ita = {
		icon = mission_italian_conquest
		position = 8
		required_missions = { spa_milan } 
		provinces_to_highlight = {  } 

		trigger = {  
			OR = { 
				accepted_culture = sicilian
				accepted_culture = neapolitan 
			}
			OR = { 
				accepted_culture = lombard
				accepted_culture = tuscan
			}
		} 

		effect = {  
			custom_tooltip = enable_ita_council.tt
			set_country_flag = italy_council_flag
		} 
	}
}
ai_cas_locked_branch_5 = {
	slot = 5
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = CAS } 

	cas_locked_5a = {
		icon = mission_locked_mission
		position = 4
		required_missions = {
			spa_iberian_wedding
			spa_navarre
		}
		provinces_to_highlight = {  
			OR = { 
				area = trasosmontes_area
				area = beieras_area
				area = estremadura_area
				area = alentejo_area
				area = algarve_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {   
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			trasosmontes_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			beieras_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			estremadura_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			alentejo_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
			algarve_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
		} 

		effect = {
			custom_tooltip = spa_unlock_mission.tt
			custom_tooltip = new_por_council.tt
			set_country_flag = portugal_council_flag
		}
	}

	cas_locked_5b = {
		icon = mission_locked_mission
		position = 5
		required_missions = { cas_locked_4a } 
		provinces_to_highlight = {  
			is_capital_of = GEN
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			OR = { 
				AND = { 
					OR = { 
						alliance_with = GEN 
						GEN = { is_subject_of = ROOT }
					}
					GEN = { 
						has_opinion = { 
							who = ROOT 
							value = 200 
						}
						owns_core_province = 101
					}
				}
				AND = { 
					NOT = { exists = GEN }
					owns_core_province = 101
				}
			}
		} 

		effect = {  
			custom_tooltip = spa_unlock_mission.tt
			custom_tooltip = genoese_banks_reform.tt
			set_country_flag = enable_gen_banks_flag
		} 
	}

	cas_locked_5c = {
		icon = mission_locked_mission
		position = 6
		required_missions = { cas_locked_4b } 
		provinces_to_highlight = {  
			province_id = 126
			NOT = { owned_by = KNI }
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			126 = { country_or_non_sovereign_subject_holds = ROOT }
			is_year = 1530
			NOT = { exists = KNI }
			custom_trigger_tooltip = { 
				tooltip = kni_koj.tt
				all_country = { 
					NOT = { has_country_flag = knights_formed_jerusalem }
				}
			}
			NOT = { 
				OR = {
					320 = { country_or_non_sovereign_subject_holds = ROOT }
					5678 = { country_or_non_sovereign_subject_holds = ROOT }
				}
			}
		} 

		effect = { 
			custom_tooltip = spa_unlock_mission.tt
			country_event = { id = flavor_kni.100 } 
		} 
	}

	cas_locked_5d = {
		icon = mission_locked_mission
		position = 7
		required_missions = { cas_locked_5c } 
		provinces_to_highlight = {  
			province_id = 354
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = { 
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			354 = { country_or_non_sovereign_subject_holds = ROOT } 
		} 

		effect = {  
			custom_tooltip = spa_unlock_mission.tt
			custom_tooltip = kni_tripoli.tt
			hidden_effect = { 
				if = { 
					limit = {
						354 = { 
							country_or_non_sovereign_subject_holds = ROOT 
							owned_by = KNI 
						}
					}
					354 = { 
						add_province_modifier = { 
							name = kni_trp_mod #missing loc
							duration = -1
						}
					}
				}
			}
		} 
	}

	cas_locked_5e = {
		icon = mission_locked_mission
		position = 8
		required_missions = { cas_locked_4d } 
		provinces_to_highlight = {  } 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			OR = { 
				accepted_culture = sicilian
				accepted_culture = neapolitan 
			}
			OR = { 
				accepted_culture = lombard
				accepted_culture = tuscan
			}
		} 

		effect = {  
			custom_tooltip = spa_unlock_mission.tt
			custom_tooltip = enable_ita_council.tt #missing loc
			set_country_flag = italy_council_flag
		} 
	}
}
ai_cas_branch_5b = {
	slot = 5
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { 
		OR = {
			tag = CAS 
			tag = SPA
			tag = SPN
		}
	} 

	cas_navy = {
		icon = mission_dominate_gujarati_trade
		position = 9
		provinces_to_highlight = {  } 

		trigger = { navy_size_percentage = 1 } 

		effect = {
			add_country_modifier = {
				name = "cas_navy_mod"
				duration = 18250
			}
		}
	}

	spa_merchant_fleet = {
		icon = mission_coromandel_trade
		position = 10
		required_missions = { cas_navy } 
		provinces_to_highlight = {
			owned_by = ROOT
			has_port = yes
			has_shipyard_building_trigger = no
		}

		trigger = {
			num_of_owned_provinces_with = {
				has_shipyard_building_trigger = yes
				value = 6
			}
			num_of_light_ship = 50
		}

		effect = {
			add_country_modifier = {
				name = "spa_powerful_trade_ships_modifier"
				duration = 9125
			}
			add_country_modifier = {
				name = "spa_employ_galleon_modifier"
				duration = -1
			}
			add_navy_tradition = 10
		}
	}

	spa_armada = {
		icon = mission_spanish_armada
		position = 11
		required_missions = { spa_merchant_fleet } 
		provinces_to_highlight = {  } 

		trigger = {
			NOT = {
				any_country = {
					navy_size = ROOT
					num_of_heavy_ship = ROOT
				}
			}
			navy_size = 300
		}

		effect = {
			add_country_modifier = {
				name = "spa_armada_mod"
				duration = -1
			}
		}
	}
}
cas_misc_branch_1 = {
	slot = 1
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { 
		OR = {
			tag = CAS 
			tag = SPA
			tag = SPN
		}
	} 

	spa_cuatro_villas = {
		icon = subiaco_press
		position = 12
		provinces_to_highlight = {  
			OR = {
				province_id = 1745
				province_id = 4962
				province_id = 4960
				province_id = 4961
			}
			NOT = { 
				AND = { 
					num_of_times_improved = 5
					has_trade_building_trigger = yes 
					has_production_building_trigger = yes
				}
			}
		} 

		trigger = {  
			1745 = { 
				num_of_times_improved = 5
				has_trade_building_trigger = yes 
				has_production_building_trigger = yes
			}
			4962 = { 
				num_of_times_improved = 5
				has_trade_building_trigger = yes 
				has_production_building_trigger = yes
			}
			4960 = { 
				num_of_times_improved = 5
				has_trade_building_trigger = yes 
				has_production_building_trigger = yes
			}
			4961 = { 
				num_of_times_improved = 5
				has_trade_building_trigger = yes 
				has_production_building_trigger = yes
			}
		} 

		effect = { country_event = { id = aetas_cas.27 } } 
	}

	cas_wool_competition = {
		icon = mission_dominate_home_trade_node
		position = 13
		required_missions = {
			spa_cuatro_villas
			spa_mesta_warehouses
		}
		provinces_to_highlight = { province_id = 1276 } 

		trigger = {  
			1276 = { 
				trade_share = { 
					country = ROOT 
					share = 25
				}
			}
		} 

		effect = {  
			1745 = { change_trade_goods = cloth }
			add_country_modifier = { 
				name = cas_trade_mod
				duration = 18250
			}
		} 
	}

	spa_administer_mesta = {
		icon = mission_taula_de_canvi
		position = 14
		required_missions = { cas_wool_competition } 
		provinces_to_highlight = {  } 

		trigger = {  
			current_age = age_of_absolutism
			any_owned_province = { has_province_modifier = merino_wool }
		} 

		effect = { country_event = { id = flavor_spa.17 } } 
	}
}
cas_misc_branch_2 = {
	slot = 2
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { 
		OR = {
			tag = CAS 
			tag = SPA
			tag = SPN
		}
	} 

	spa_mesta_warehouses = {
		icon = mission_have_manufactories
		position = 12
		provinces_to_highlight = {  
			OR = { 
				province_id = 4789
				province_id = 2755
				province_id = 208
				province_id = 2741
			}
			NOT = { 
				AND = { 
					owned_by = ROOT 
					is_core = ROOT 
					base_production = 5
					has_production_building_trigger = yes 
					has_manufactory_trigger = yes 
				}
			}
		} 

		trigger = {  
			4789 = { 
				owned_by = ROOT 
				is_core = ROOT 
				base_production = 5
				has_production_building_trigger = yes 
				has_manufactory_trigger = yes 
			}
			2755 = { 
				owned_by = ROOT 
				is_core = ROOT 
				base_production = 5
				has_production_building_trigger = yes 
				has_manufactory_trigger = yes 
			}
			2751 = { 
				owned_by = ROOT 
				is_core = ROOT 
				base_production = 5
				has_production_building_trigger = yes 
				has_manufactory_trigger = yes 
			}
			208 = { 
				owned_by = ROOT 
				is_core = ROOT 
				base_production = 5
				has_production_building_trigger = yes 
				has_manufactory_trigger = yes 
			}
		} 

		effect = {  
			4789 = { 
				add_province_modifier = { 
					name = mesta_warehouse
					duration = -1
				}
			}
			2755 = { 
				add_province_modifier = { 
					name = mesta_warehouse
					duration = -1
				}
			}
			2751 = { 
				add_province_modifier = { 
					name = mesta_warehouse
					duration = -1
				}
			}
			208 = { 
				add_province_modifier = { 
					name = mesta_warehouse
					duration = -1
				}
			}
		} 
	}
}
dom_cas_missions_1_c = {
	slot = 1
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		has_dlc = "Domination"
		OR = {
			tag = CAS
			was_tag = CAS
		}
	}

	gc_cas_spa_la_plata2 = {
		icon = mission_expel_the_moriscos
		position = 15
		required_missions = { gc_cas_spa_caribbean_discovery2 } 
		provinces_to_highlight = {
			colonial_region = colonial_la_plata
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
			has_discovered = yes
		}

		trigger = {
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				value = 5
				colonial_region = colonial_la_plata
				is_city = yes
			}
		}

		effect = {
			add_country_modifier = {
				name = "spa_rb_overseas_trade"
				duration = 5475
			}
			add_mercantilism = 2
		}
	}

	gc_cas_spa_new_granada2 = {
		icon = mission_new_kingdom_of_granada
		position = 16
		required_missions = { gc_cas_spa_spanish_main2 } 
		provinces_to_highlight = {
			colonial_region = colonial_colombia
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
		}

		trigger = {
			if = {
				limit = {
					has_dlc = "Golden Century"
					religion = catholic
				}
				custom_trigger_tooltip = {
					tooltip = colombia_holy_order_tooltip
					num_of_states_owned_or_owned_by_non_sovereign_subjects_with = {
						has_holy_order_trigger = yes
						colonial_region = colonial_colombia
						value = 5
					}
				}
			}
			else = {
				custom_trigger_tooltip = {
					tooltip = colombia_holy_order_alternative_tooltip
					num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
						religion = ROOT
						colonial_region = colonial_colombia
						value = 25
					}
				}
			}
			colonial_colombia = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}

		effect = {
			add_dip_power = 100
			if = {
				limit = { government = monarchy } 
				add_legitimacy = 25
			}
			add_country_modifier = {
				name = "spa_new_granada"
				duration = 7300
			}
			if = {
				limit = {
					any_subject_country = {
						OR = {
							is_subject_of_type = colony
							is_subject_of_type = crown_colony
							is_subject_of_type = private_enterprise
							is_subject_of_type = self_governing_colony
						}
						owns = 825
					}
					825 = { is_capital = no } 
				}
				every_subject_country = {
					limit = { owns = 825 } 
					825 = { prev_move_capital_effect = yes } 
				}
			}
		}
	}
}
dom_cas_missions_2_c = {
	slot = 2
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		has_dlc = "Domination"
		OR = {
			tag = CAS
			was_tag = CAS
		}
	}

	spa_sevilla_port = {
		icon = adriatic_access
		position = 13
		provinces_to_highlight = { province_id = 224 } 

		trigger = {
			224 = { owned_by = ROOT } 
			224 = {
				if = {
					limit = { has_dlc = "Leviathan" } 
					num_of_times_expanded_infrastructure = 1
				}
			}
			224 = { num_of_times_improved = 10 } 
			224 = { has_trade_building_trigger = yes } 
			224 = { has_dock_building_trigger = yes } 
			224 = { has_shipyard_building_trigger = yes } 
		}

		effect = {
			set_country_flag = sevilla_trade_center_flag
			country_event = { id = flavor_spa.3153 } 
			224 = { upgrade_building = { trade = yes }  } 
		}
	}

	spa_dominate_sevilla = {
		icon = spa_dominate_sevilla
		position = 14
		required_missions = {
			spa_sevilla_port
			gc_cas_spa_plus_ultra2
		}
		provinces_to_highlight = { province_id = 1293 } 

		trigger = {
			1293 = {
				trade_share = {
					country = ROOT
					share = 70
				}
			}
		}

		effect = {
			add_country_modifier = {
				name = "spa_spanish_affluence_modifier"
				duration = 7300
			}
			if = {
				limit = { NOT = { mission_completed = gc_cas_spa_havana2 }  } 
				set_country_flag = spa_house_of_trade_flag
				country_event = { id = flavor_spa.1003 } 
				custom_tooltip = spa_event_insight_1003_tt
			}
		}
	}

	gc_cas_spa_spanish_main2 = {
		icon = mission_establish_high_seas_navy
		position = 15
		required_missions = { gc_cas_spa_caribbean_discovery2 } 
		provinces_to_highlight = {
			colonial_region = colonial_colombia
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
			has_discovered = yes
		}

		trigger = {
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				value = 5
				colonial_region = colonial_colombia
				is_city = yes
			}
		}

		effect = {
			define_conquistador = {
				name = "Francisco Pizarro"
				fire = 4
				shock = 4
				manuever = 5
				siege = 1
			}
			upper_peru = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			potosi_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			antisuyu_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			kuntisuyu_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			huanuco_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			cajamarca_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			quito_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			794 = { add_permanent_claim = ROOT } 
			2837 = { add_permanent_claim = ROOT } 
			2823 = { add_permanent_claim = ROOT } 
			2826 = { add_permanent_claim = ROOT } 
			812 = { add_permanent_claim = ROOT } 
			2822 = { add_permanent_claim = ROOT } 
			2821 = { add_permanent_claim = ROOT } 
			guatemala_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			east_yucatan_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			yucatan_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			chiapas_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			oaxaca_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			eastern_mexico_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			guerrero_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			michoacan_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			2657 = { add_permanent_claim = ROOT } 
			2621 = { add_permanent_claim = ROOT } 
			854 = { add_permanent_claim = ROOT } 
			2642 = { add_permanent_claim = ROOT } 
		}
	}

	gc_cas_spa_incans2 = {
		icon = mission_war_chest
		position = 16
		required_missions = { gc_cas_spa_spanish_main2 } 
		provinces_to_highlight = {
			OR = {
				area = upper_peru
				area = potosi_area
				area = antisuyu_area
				area = kuntisuyu_area
				province_id = 794
				province_id = 2837
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
			has_discovered = ROOT
		}

		trigger = {
			upper_peru = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			potosi_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			antisuyu_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			kuntisuyu_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			794 = { country_or_non_sovereign_subject_holds = ROOT } 
			2837 = { country_or_non_sovereign_subject_holds = ROOT } 
		}

		effect = {
			add_country_modifier = {
				name = "spa_overseas_wealth_modifier"
				duration = 9125
			}
			peru_region = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		}
	}

	gc_cas_spa_potosi2 = {
		icon = mission_potosi_silver
		position = 17
		required_missions = { gc_cas_spa_incans2 } 
		provinces_to_highlight = {
			OR = {
				AND = {
					province_id = 795
					NOT = { country_or_non_sovereign_subject_holds = ROOT } 
				}
				AND = {
					province_id = 809
					NOT = { country_or_non_sovereign_subject_holds = ROOT } 
				}
				AND = {
					OR = {
						province_id = 809
						province_id = 835
						province_id = 1516
					}
					NOT = { is_strongest_trade_power = ROOT } 
				}
				AND = {
					province_id = 809
					NOT = { province_has_center_of_trade_of_level = 3 } 
				}
			}
		}

		trigger = {
			owns_or_non_sovereign_subject_of = 809
			owns_or_non_sovereign_subject_of = 795
			809 = { country_or_non_sovereign_subject_holds = ROOT } 
			if = {
				limit = { has_dlc = "Dharma" } 
				809 = { province_has_center_of_trade_of_level = 3 } 
			}
			else = {
				809 = {
					OR = {
						has_building = trade_depot
						has_building = stock_exchange
					}
				}
			}
			809 = { is_strongest_trade_power = ROOT } 
			835 = { is_strongest_trade_power = ROOT } 
			1516 = { is_strongest_trade_power = ROOT } 
		}

		effect = {
			custom_tooltip = gc_cas_spa_potosi_tt
			hidden_effect = {
				if = {
					limit = {
						any_subject_country = {
							OR = {
								is_subject_of_type = colony
								is_subject_of_type = crown_colony
								is_subject_of_type = private_enterprise
								is_subject_of_type = self_governing_colony
							}
							owns = 809
						}
					}
					every_subject_country = {
						limit = { owns = 809 } 
						809 = { prev_move_capital_effect = yes } 
					}
				}
			}
			if = {
				limit = { has_dlc = "Leviathan" } 
				795 = { set_great_project_tier_2 = { type = potosi }  } 
			}
			else = {
				795 = {
					add_province_modifier = {
						name = "spa_rb_gold_rush"
						duration = 5475
					}
				}
			}
			2946 = {
				add_province_modifier = {
					name = "spa_rb_gold_rush"
					duration = 5475
				}
			}
			2941 = {
				add_province_modifier = {
					name = "spa_rb_gold_rush"
					duration = 5475
				}
			}
			804 = {
				add_province_modifier = {
					name = "spa_rb_gold_rush"
					duration = 5475
				}
			}
		}
	}

	spa_new_world_silver = {
		icon = mission_african_gold
		position = 19
		required_missions = {
			gc_cas_spa_new_spain2
			gc_cas_spa_potosi2
		}
		provinces_to_highlight = {
			country_or_non_sovereign_subject_holds = ROOT
			trade_goods = gold
			NOT = { base_production = 10 } 
		}

		trigger = {
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				trade_goods = gold
				base_production = 10
				value = 10
			}
		}

		effect = {
			custom_tooltip = spa_every_gold_province_tt
			tooltip = {
				add_province_modifier = {
					name = "spa_spanish_silver_and_gold_modifier"
					duration = -1
				}
			}
			hidden_effect = {
				every_province = {
					limit = {
						country_or_non_sovereign_subject_holds = ROOT
						trade_goods = gold
					}
					add_province_modifier = {
						name = "spa_spanish_silver_and_gold_modifier"
						duration = -1
					}
				}
			}
		}
	}
}
dom_cas_missions_3_c = {
	slot = 3
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		has_dlc = "Domination"
		OR = {
			tag = CAS
			was_tag = CAS
		}
	}

	gc_cas_spa_caribbean_discovery2 = {
		icon = explore_caribbean
		position = 14
		required_missions = { gc_cas_spa_plus_ultra2 } 
		provinces_to_highlight = {
			colonial_region = colonial_the_carribean
			NOT = { has_discovered = ROOT } 
		}

		trigger = {
			if = {
				limit = { is_random_new_world = yes } 
				custom_trigger_tooltip = {
					tooltip = cas_carib_rnw
					any_owned_province = { continent = new_world } 
				}
			}
			else = {
				custom_trigger_tooltip = {
					tooltip = miss_discover_caribbean
					colonial_the_carribean = { has_discovered = ROOT } 
				}
			}
		}

		effect = {
			create_conquistador = { tradition = 75 } 
			add_country_modifier = {
				name = "spa_hispaniola_discovered"
				duration = 5475
			}
		}
	}

	gc_cas_spa_caribbean_colony2 = {
		icon = mission_iberian_conquistador
		position = 15
		required_missions = { gc_cas_spa_caribbean_discovery2 } 
		provinces_to_highlight = {
			colonial_region = colonial_the_carribean
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
			has_discovered = ROOT
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = miss_colonize_caribbean
				num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
					value = 1
					colonial_region = colonial_the_carribean
					is_city = yes
				}
			}
		}

		effect = {
			add_prestige_or_monarch_power = { amount = 20 } 
			add_country_modifier = {
				name = "the_unknown_frontier"
				duration = 5475
			}
		}
	}

	gc_cas_spa_mayans2 = {
		icon = mission_mayan_conquest
		position = 17
		required_missions = { gc_cas_spa_hispaniola2 } 
		provinces_to_highlight = {
			region = central_america_region
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
			has_discovered = ROOT
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = spa_mayan_conquest_tooltip
				central_america_region = {
					type = all
					OR = {
						is_empty = yes
						country_or_non_sovereign_subject_holds = ROOT
					}
				}
			}
		}

		effect = {
			add_country_modifier = {
				name = "spa_transatlantic_migrations_modifier"
				duration = 9125
			}
		}
	}

	gc_cas_spa_california2 = {
		icon = mission_colonize_california
		position = 19
		required_missions = { gc_cas_spa_new_spain2 } 
		provinces_to_highlight = {
			colonial_region = colonial_california
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
			has_discovered = ROOT
		}

		trigger = {
			if = {
				limit = {
					has_dlc = "Golden Century"
					religion = catholic
				}
				2021 = {
					country_or_non_sovereign_subject_holds = ROOT
					has_holy_order_trigger = yes
				}
			}
			else = {
				2021 = {
					country_or_non_sovereign_subject_holds = ROOT
					religion = ROOT
				}
			}
			4637 = {
				country_or_non_sovereign_subject_holds = ROOT
				religion = ROOT
			}
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				value = 5
				colonial_region = colonial_california
				is_city = yes
			}
		}

		effect = {
			add_dip_power = 100
			2021 = { add_base_tax = 3 } 
			4637 = {
				add_center_of_trade_level = 1
				add_base_production = 4
			}
			colonial_california = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		}
	}
}
dom_cas_missions_4_c = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		has_dlc = "Domination"
		OR = {
			tag = CAS
			was_tag = CAS
		}
	}

	gc_cas_spa_plus_ultra2 = {
		icon = mission_plus_ultra
		position = 13
		required_missions = { spa_royal_cae } 
		provinces_to_highlight = {
			province_id = 4565
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
		}

		trigger = {
			num_of_explorers = 1
			custom_trigger_tooltip = {
				tooltip = spa_plus_ultra_tooltip
				OR = {
					owns_core_province = 4565
					any_owned_province = {
						OR = {
							continent = north_america
							continent = south_america
							continent = new_world
						}
					}
				}
			}
		}

		effect = {
			add_country_modifier = {
				name = "spa_plus_ultra"
				duration = 7300
			}
			if = {
				limit = {
					has_dlc = "Rights of Man"
					NOT = { num_of_ruler_traits = { amount = 3 }  } 
				}
				add_ruler_personality = expansionist_personality
			}
			else = { add_dip_power = 50 } 
		}
	}

	dom_castile_exploration_ideas = {
		icon = imperial_navy
		position = 14
		required_missions = { gc_cas_spa_plus_ultra2 } 
		provinces_to_highlight = {  } 

		trigger = {
			OR = {
				full_idea_group = exploration_ideas
				full_idea_group = expansion_ideas
			}
		}

		effect = {
			if = {
				limit = { has_dlc = "Rights of Man" } 
				custom_tooltip = por_more_likely_to_get_expansionist_tt
				set_country_flag = por_more_likely_to_get_expansionist_flag
				change_ruler_stat = {
					type = dip
					amount = 1
				}
			}
			else = {
				change_ruler_stat = {
					type = dip
					amount = 2
				}
				add_prestige_or_monarch_power = { amount = 10 } 
			}
			if = {
				limit = { POR = { NOT = { mission_completed = dom_portugal_exploration_ideas }  }  } 
				custom_tooltip = cas_race_portugal_event_tt
				country_event = { id = flavor_spa.199 } 
			}
		}
	}

	dom_castile_circumnavigation = {
		icon = mission_explore_the_world
		position = 15
		required_missions = { dom_castile_exploration_ideas } 
		provinces_to_highlight = {  } 

		trigger = {
			OR = {
				custom_trigger_tooltip = {
					tooltip = achievement_magellans_voyage_tooltip
					has_country_flag = circumnavigation_first
				}
				custom_trigger_tooltip = {
					tooltip = second_circumnavigation_tt
					has_country_flag = circumnavigation_done
				}
			}
		}

		effect = {
			if = {
				limit = { has_country_flag = circumnavigation_first } 
				add_country_modifier = {
					name = "por_first_circumnavigation_modifier"
					duration = -1
				}
			}
			else = {
				add_country_modifier = {
					name = "por_first_circumnavigation_modifier"
					duration = 9125
				}
			}
		}
	}

	gc_cas_spa_hispaniola2 = {
		icon = mission_claim_hispaniola
		position = 16
		required_missions = { gc_cas_spa_caribbean_colony2 } 
		provinces_to_highlight = {
			OR = {
				AND = {
					OR = {
						area = hispaniola_area
						area = dominica_area
					}
					NOT = { country_or_non_sovereign_subject_holds = ROOT } 
				}
				province_id = 490
			}
			has_discovered = ROOT
		}

		trigger = {
			if = {
				limit = { has_dlc = "Rights of Man" } 
				490 = {
					country_or_non_sovereign_subject_holds = ROOT
					OR = {
						has_building = temple
						has_building = cathedral
					}
				}
			}
			else = { 490 = { country_or_non_sovereign_subject_holds = ROOT }  } 
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				value = 5
				OR = {
					area = hispaniola_area
					area = dominica_area
				}
				is_city = yes
			}
		}

		effect = {
			define_conquistador = {
				shock = 5
				fire = 5
				manuever = 6
				siege = 1
				name = "Hernn Corts"
			}
			490 = {
				add_base_production = 3
				if = {
					limit = { NOT = { trade_goods = sugar }  } 
					change_trade_goods = sugar
				}
			}
			central_america_region = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		}
	}

	gc_cas_spa_new_spain2 = {
		icon = mission_kingdom_of_new_spain
		position = 18
		required_missions = {
			gc_cas_spa_aztecs2
			gc_cas_spa_mayans2
		}
		provinces_to_highlight = {
			region = mexico_region
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
			has_discovered = ROOT
		}

		trigger = {
			if = {
				limit = {
					has_dlc = "Golden Century"
					religion = catholic
				}
				custom_trigger_tooltip = {
					tooltip = mexico_holy_order_tooltip
					num_of_states_owned_or_owned_by_non_sovereign_subjects_with = {
						has_holy_order_trigger = yes
						region = mexico_region
						value = 5
					}
				}
			}
			else = {
				custom_trigger_tooltip = {
					tooltip = mexico_holy_order_alternative_tooltip
					num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
						religion = ROOT
						region = mexico_region
						value = 25
					}
				}
			}
			mexico_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}

		effect = {
			add_country_modifier = {
				name = "viceroyalty_of_new_spain"
				duration = -1
			}
			if = {
				limit = {
					any_subject_country = {
						OR = {
							is_subject_of_type = colony
							is_subject_of_type = crown_colony
							is_subject_of_type = private_enterprise
							is_subject_of_type = self_governing_colony
						}
						owns = 852
					}
					852 = { is_capital = no } 
				}
				every_subject_country = {
					limit = { owns = 852 } 
					852 = { prev_move_capital_effect = yes } 
				}
			}
			west_florida_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
					is_empty = no
				}
				add_permanent_claim = ROOT
			}
			california_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
					is_empty = no
				}
				add_permanent_claim = ROOT
			}
			mississippi_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
					is_empty = no
				}
				add_permanent_claim = ROOT
			}
		}
	}

	gc_cas_spa_florida2 = {
		icon = mission_colonize_florida
		position = 19
		required_missions = { gc_cas_spa_new_spain2 } 
		provinces_to_highlight = {
			OR = {
				region = southeast_america_region
				area = west_florida_area
			}
			OR = {
				NOT = { country_or_non_sovereign_subject_holds = ROOT } 
				NOT = { fort_level = 3 } 
			}
			has_discovered = ROOT
		}

		trigger = {
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				value = 3
				OR = {
					region = southeast_america_region
					area = west_florida_area
				}
				fort_level = 3
			}
		}

		effect = {
			add_mil_power = 100
			custom_tooltip = fortified_florida_tooltip
			hidden_effect = {
				every_province = {
					limit = {
						OR = {
							owned_by = ROOT
							owner = { is_subject_of = ROOT } 
						}
						OR = {
							region = southeast_america_region
							area = west_florida_area
						}
						fort_level = 3
					}
					add_province_modifier = {
						name = "fortified_florida_modifier"
						duration = -1
					}
				}
			}
		}
	}
}
dom_cas_missions_5_c = {
	slot = 5
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		has_dlc = "Domination"
		OR = {
			tag = CAS
			was_tag = CAS
		}
	}

	gc_cas_spa_west_africa2 = {
		icon = mission_west_african_ports
		position = 13
		required_missions = { spa_royal_cae } 
		provinces_to_highlight = {
			OR = {
				AND = {
					region = guinea_region
					NOT = { country_or_non_sovereign_subject_holds = ROOT } 
				}
				province_id = 1466
			}
			has_discovered = ROOT
		}

		trigger = {
			guinea_region = { owned_by = ROOT } 
			1466 = { is_strongest_trade_power = ROOT } 
		}

		effect = {
			add_mercantilism = 2
			add_country_modifier = {
				name = "spa_invest_in_west_africa_modifier"
				duration = 9125
			}
		}
	}

	gc_cas_spa_discover_spice_islands2 = {
		icon = mission_sail_to_the_east_indies
		position = 14
		required_missions = {
			gc_cas_spa_west_africa2
			gc_cas_spa_plus_ultra2
		}
		provinces_to_highlight = {  } 

		trigger = {
			custom_trigger_tooltip = {
				tooltip = cas_spice_islands_tooltip
				moluccas_region = {
					type = all
					has_discovered = ROOT
				}
			}
		}

		effect = {
			mindanao_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			west_mindanao_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			visayas_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			palawan_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			luzon_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			southern_luzon_area = {
				limit = {
					NOT = { is_core = ROOT } 
					NOT = { is_permanent_claim = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		}
	}

	gc_cas_spa_conquer_philippines2 = {
		icon = mission_las_islas_filipinas
		position = 15
		required_missions = { gc_cas_spa_discover_spice_islands2 } 
		provinces_to_highlight = {
			OR = {
				area = mindanao_area
				area = west_mindanao_area
				area = visayas_area
				area = palawan_area
				area = luzon_area
				area = southern_luzon_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
			has_discovered = ROOT
		}

		trigger = {
			southern_luzon_area = {
				type = all
				owned_by = ROOT
			}
			luzon_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			mindanao_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			west_mindanao_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			visayas_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			palawan_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			224 = { country_or_non_sovereign_subject_holds = ROOT } 
		}

		effect = {
			224 = {
				change_trade_goods = cloves
				add_base_production = 3
			}
			southern_luzon_area = {
				limit = { owned_by = ROOT } 
				change_religion = ROOT
			}
			luzon_area = {
				limit = { owned_by = ROOT } 
				change_religion = ROOT
			}
			if = {
				limit = {
					has_dlc = "Dharma"
					656 = { NOT = { province_has_center_of_trade_of_level = 2 }  } 
				}
				656 = { add_center_of_trade_level = 1 } 
			}
		}
	}

	gc_cas_spa_havana2 = {
		icon = mission_found_havana
		position = 16
		required_missions = { gc_cas_spa_caribbean_colony2 } 
		provinces_to_highlight = {
			OR = {
				area = cuba_area
				area = east_cuba_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
			has_discovered = ROOT
		}

		trigger = {
			if = {
				limit = { has_dlc = "Rights of Man" } 
				484 = {
					country_or_non_sovereign_subject_holds = ROOT
					OR = {
						has_building = workshop
						has_building = counting_house
					}
				}
			}
			else = { 484 = { country_or_non_sovereign_subject_holds = ROOT }  } 
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				value = 5
				OR = {
					area = cuba_area
					area = east_cuba_area
				}
			}
		}

		effect = {
			if = {
				limit = {
					NOT = { has_country_flag = spa_house_of_trade_flag } 
					NOT = { mission_completed = spa_dominate_sevilla } 
				}
				set_country_flag = spa_house_of_trade_flag
				country_event = { id = flavor_spa.1003 } 
				custom_tooltip = spa_event_insight_1003_tt
			}
			else = {
				change_ruler_stat = {
					type = dip
					amount = 1
				}
				add_mercantilism = 3
			}
			if = {
				limit = {
					any_subject_country = {
						OR = {
							is_subject_of_type = colony
							is_subject_of_type = crown_colony
							is_subject_of_type = private_enterprise
							is_subject_of_type = self_governing_colony
						}
						owns = 484
						484 = { is_capital = no } 
					}
				}
				every_subject_country = {
					limit = { owns = 484 } 
					484 = { prev_move_capital_effect = yes } 
				}
			}
			mexico_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			eastern_mexico_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			puebla_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		}
	}

	gc_cas_spa_aztecs2 = {
		icon = mission_iberian_conquistador
		position = 17
		required_missions = { gc_cas_spa_havana2 } 
		provinces_to_highlight = {
			OR = {
				area = mexico_area
				area = eastern_mexico_area
				area = puebla_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT } 
			has_discovered = ROOT
		}

		trigger = {
			mexico_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			eastern_mexico_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			puebla_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}

		effect = {
			add_country_modifier = {
				name = "spa_aztecs_conquest_modifier"
				duration = 7300
			}
			add_years_of_income = 1
			mexico_region = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		}
	}

	gc_cas_spa_native_reductions2 = {
		icon = mission_native_reductions
		position = 19
		required_missions = { gc_cas_spa_new_spain2 } 
		provinces_to_highlight = {
			province_id = 216
			OR = {
				NOT = { country_or_non_sovereign_subject_holds = ROOT } 
				NOT = { has_building = university } 
			}
		}

		trigger = {
			if = {
				limit = {
					has_dlc = "Golden Century"
					religion = catholic
				}
				custom_trigger_tooltip = {
					tooltip = native_reductions_tooltip
					num_of_states_owned_or_owned_by_non_sovereign_subjects_with = {
						has_holy_order_trigger = yes
						OR = {
							continent = north_america
							continent = south_america
						}
						value = 15
					}
				}
			}
			else = {
				custom_trigger_tooltip = {
					tooltip = native_reductions_alternative_tooltip
					num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
						religion = ROOT
						OR = {
							continent = north_america
							continent = south_america
						}
						value = 75
					}
				}
			}
			216 = { has_building = university } 
		}

		effect = {
			if = {
				limit = { religion = catholic } 
				add_country_modifier = {
					name = "spa_enforced_catholicism_modifier"
					duration = -1
				}
			}
			else = { add_dip_power = 100 } 
			if = {
				limit = {
					any_country = {
						is_subject_of = ROOT
						OR = {
							is_subject_of_type = colony
							is_subject_of_type = crown_colony
							is_subject_of_type = private_enterprise
							is_subject_of_type = self_governing_colony
						}
					}
				}
				every_country = {
					limit = {
						is_subject_of = ROOT
						is_subject_of_type = colony
					}
					add_country_modifier = {
						name = "spa_native_reductions"
						duration = 7300
					}
				}
			}
		}
	}
}
