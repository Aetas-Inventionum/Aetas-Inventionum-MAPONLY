sav_branch_1 = {
	slot = 1
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { 
		OR = { 
			tag = SAV 
			tag = SPI 
			tag = SCI
			tag = SVY
		}
	} 

	sav_order_saint_maurice = {
		icon = a_center_of_religion
		position = 1
		provinces_to_highlight = {  } 

		trigger = {  
			stability = 1
			papal_influence = 20
		} 

		effect = { country_event = { id = new_flavour_sav.2 } } 
	}

	sav_antipope = {
		icon = mission_felix_v
		position = 2
		required_missions = {
			sav_embassies
			sav_order_saint_maurice
		}
		provinces_to_highlight = {  } 

		trigger = {  
			OR = { 
				custom_trigger_tooltip = { 
					tooltip = felix_antipope.tt
					has_country_flag = felix_antipope_flag
				}
				AND = { 
					is_year = 1440
					NOT = { 
						custom_trigger_tooltip = { 
							tooltip = felix_antipope.tt
							has_country_flag = felix_antipope_flag
						}
					}
				}
			}
		} 

		effect = {  
			if = { 
				limit = { has_country_modifier = sav_church_mod }
				add_dip_power = 100
			}
			else = { 4720 = { add_permanent_claim = ROOT } }
		} 
	}

	sav_geneva = {
		icon = sway_geneva
		position = 3
		required_missions = { sav_antipope } 
		provinces_to_highlight = {  
			province_id = 4720
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			if = {
				limit = { 
					has_country_modifier = sav_church_mod 
					exists = GNV 
				}
				PAP = { 
					has_opinion = { 
						who = ROOT 
						value = 125
					}
				}
			}
			else = { 4720 = { country_or_non_sovereign_subject_holds = ROOT } }
		} 

		effect = {  
			if = {
				limit = { 
					has_country_modifier = sav_church_mod 
					exists = GNV 
				}
				create_subject = { 
					who = GNV 
					subject_type = fief 
				}
				GNV = { 
					define_ruler = { 
						dynasty = "de Savoie"
						culture = arpitan 
					} 	
					hidden_effect = { change_country_color = { country = LNN } }
				}
			}
			4721 = { add_permanent_claim = ROOT }
		} 
	}

	sav_fbg = {
		icon = military_self_reliance
		position = 4
		required_missions = { sav_geneva } 
		provinces_to_highlight = {  
			province_id = 4721
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = { 4721 = { country_or_non_sovereign_subject_holds = ROOT } } 

		effect = {  
			romandie_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}
}
sav_branch_2 = {
	slot = 2
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { 
		OR = { 
			tag = SAV 
			tag = SPI 
			tag = SCI
			tag = SVY
		}
	} 

	sav_embassies = {
		icon = friends_in_high_places
		position = 1
		provinces_to_highlight = {  } 

		trigger = {  
			if = { 
				limit = { exists = BUR }
				reverse_has_opinion = { 
					who = BUR 
					value = 150
				}
			}
			any_ally = { 
				culture_group = germanic 
				has_opinion = { 
					who = ROOT 
					value = 100
				}
			}
			any_ally = { 
				culture_group = latin
				has_opinion = { 
					who = ROOT 
					value = 100
				}
			}
		} 

		effect = {  
			add_country_modifier = {
				name = sav_savoyard_diplomacy
				duration = 7300
			}
		} 
	}

	sav_golden_fleece = {
		icon = mission_bur_charles
		position = 2
		required_missions = { sav_embassies } 
		provinces_to_highlight = {  } 

		trigger = {  
			OR = { 
				NOT = { exists = BUR }
				AND = { 
					alliance_with = BUR 
					BUR = { 
						has_opinion = { 
							who = ROOT 
							value = 200 
						}
					}
					prestige = 25 
				}
			}
		} 

		effect = { country_event = { id = aetas_sav.6 } } 
	}

	sav_cyp = {
		icon = kingdom_of_cyprus
		position = 3
		required_missions = { sav_golden_fleece } 
		provinces_to_highlight = {  
			area = cyprus_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			cyprus_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
		} 

		effect = {  
			custom_tooltip = sav_cyp.tt
			hidden_effect = { 
				add_country_modifier = { 
					name = sav_cyp_mod
					duration = -1
				}
			}
			palestine_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}

	sav_koj = {
		icon = kingdom_of_heaven
		position = 4
		required_missions = { sav_cyp } 
		provinces_to_highlight = {  
			area = palestine_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			palestine_area = { 
				country_or_non_sovereign_subject_holds = ROOT
				type = all 
			}
		} 

		effect = {  
			add_country_modifier = { 
				name = sav_koj_mod
				duration = -1
			}
		} 
	}

	sav_mlo = {
		icon = control_the_vatican
		position = 5
		required_missions = { sav_novara } 
		provinces_to_highlight = {  
			area = lombardy_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			lombardy_area = { 
				country_or_non_sovereign_subject_holds = ROOT
				type = all 
			}
		} 

		effect = {  
			add_country_modifier = { 
				name = sav_mlo_mod
				duration = -1
			}
			if = { 
				limit = { 
					OR = { 
						tag = SPI 
						tag = SCI 
					}
				}
				po_valley_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				emilia_romagna_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
			}
		} 
	}
}
sav_branch_3 = {
	slot = 3
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { 
		OR = { 
			tag = SAV 
			tag = SPI 
			tag = SCI
			tag = SVY
		}
	} 

	sav_pie = {
		icon = secure_our_rule
		position = 1
		provinces_to_highlight = {  
			OR = { 
				province_id = 5043
				province_id = 103
				province_id = 5041
				province_id = 5040
			}
			NOT = { 
				AND = { 
					owned_by = ROOT 
					is_core = ROOT 
				}
			}
		} 

		trigger = {  
			owns_core_province = 5043
			owns_core_province = 103
			owns_core_province = 5041
			owns_core_province = 5040
		} 

		effect = {  
			add_country_modifier = { 
				name = sav_pie_integration
				duration = 7300
			}
		} 
	}

	sav_vercelli = {
		icon = king_of_kings
		position = 2
		required_missions = {
			sav_pie
			sav_embassies
		}
		provinces_to_highlight = {  
			province_id = 5048
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			OR = {
				AND = { 
					is_at_war = no 
					MLO = { 
						owns_core_province = 5048
						has_opinion = { 
							who = ROOT 
							value = 100
						}
					}
				}
				5048 = { country_or_non_sovereign_subject_holds = ROOT }
			}
		} 

		effect = {  
			custom_tooltip = sav_mlo.tt
			hidden_effect = { 
				if = { 
					limit = { NOT = { 5048 = { country_or_non_sovereign_subject_holds = ROOT } } }
					MLO = { country_event = { id = aetas_sav.5 } }
				}
			}
			if = { 
				limit = { exists = MFA }
				add_casus_belli = {
					target = MFA
					type = cb_vassalize_mission
					months = 240
				}
			}
			else = { 
				2981 = { add_permanent_claim = ROOT }
				5050 = { add_permanent_claim = ROOT }
			}
		} 
	}

	sav_mfa = {
		icon = byz_justinians_ambition
		position = 3
		required_missions = { sav_vercelli } 
		provinces_to_highlight = {  
			OR = { 
				province_id = 2981
				province_id = 5050
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			2981 = { country_or_non_sovereign_subject_holds = ROOT }
			5050 = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		effect = {  
			custom_tooltip = sav_mfa.tt
			hidden_effect = { 
				if = { 
					limit = { 
						MFA = { 
							is_subject_of = ROOT 
							is_lesser_in_union = no
						}
					}
					create_subject = { 
						who = MFA 
						subject_type = fief 
					}
					MFA = { change_country_color = { country = PIE } }
				}
			}
			add_core = 5049
			5053 = { add_permanent_claim = ROOT }
			2979 = { add_permanent_claim = ROOT }
			5055 = { add_permanent_claim = ROOT }
		} 
	}

	sav_novara = {
		icon = mission_the_sudebnik
		position = 4
		required_missions = { sav_mfa } 
		provinces_to_highlight = {  
			OR = { 
				province_id = 5053
				province_id = 2979
				province_id = 5055
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			5053 = { country_or_non_sovereign_subject_holds = ROOT }
			2979 = { country_or_non_sovereign_subject_holds = ROOT }
			5055 = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		effect = {  
			lombardy_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			liguria_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}

	sav_gen = {
		icon = fra_restore_signoria
		position = 5
		required_missions = { sav_novara } 
		provinces_to_highlight = {  
			area = liguria_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			liguria_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
		} 

		effect = {  
			add_country_modifier = { 
				name = sav_gen_mod
				duration = -1
			}
			corsica_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
			if = { 
				limit = {
					OR = { 
						tag = SPI 
						tag = SCI 
					}
				}
				tuscany_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
			}
		} 
	}
}
sav_branch_4 = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { 
		OR = { 
			tag = SAV 
			tag = SPI 
			tag = SCI
			tag = SVY
		}
	} 

	sav_statuta = {
		icon = mission_sav_coa
		position = 2
		required_missions = {
			sav_ducal
			sav_pie
		}
		provinces_to_highlight = {  } 

		trigger = {  
			legitimacy = 100
			adm = 5
			government_reform_progress = 100
			reform_level = 2
		} 

		effect = { add_government_reform = statuta_sabaudiae_reform } 
	}

	sav_fortify = {
		icon = alpine_fortifications
		position = 3
		required_missions = {
			sav_statuta
			sav_charters
		}
		provinces_to_highlight = {  
			OR = { 
				province_id = 205
				province_id = 5044
				province_id = 5045
				province_id = 5043
				province_id = 1875
			}
			NOT = { 
				AND = { 
					owned_by = ROOT 
					is_core = ROOT 
					has_fort_building_trigger = yes 
				}
			}
		} 

		trigger = {  
			205 = { 
				owned_by = ROOT 
				is_core = ROOT 
				has_fort_building_trigger = yes 
			}
			5044 = { 
				owned_by = ROOT 
				is_core = ROOT 
				has_fort_building_trigger = yes 
			}
			5045 = { 
				owned_by = ROOT 
				is_core = ROOT 
				has_fort_building_trigger = yes 
			}
			5043 = { 
				owned_by = ROOT 
				is_core = ROOT 
				has_fort_building_trigger = yes 
			}
			1875 = { 
				owned_by = ROOT 
				is_core = ROOT 
				has_fort_building_trigger = yes 
			}
		} 

		effect = {  
			custom_tooltip = emp_mlo_fortify_alps_effects_tooltip
			hidden_effect = {
				every_owned_province = {
					limit = {
						OR = { 
							province_id = 205
							province_id = 5044
							province_id = 5045
							province_id = 5043
							province_id = 1875
						}
						has_building = fort_18th
					}
					add_province_modifier = {
						name = mlo_expanded_fortifications
						duration = 36500
					}
				}
				every_owned_province = {
					limit = {
						OR = { 
							province_id = 205
							province_id = 5044
							province_id = 5045
							province_id = 5043
							province_id = 1875
						}
					}
					if = {
						limit = { has_building = fort_17th }
						remove_building = fort_17th
						add_building = fort_18th
					}
					else_if = {
						limit = { has_building = fort_16th }
						remove_building = fort_16th
						add_building = fort_17th
					}
					else_if = {
						limit = { has_building = fort_15th }
						remove_building = fort_15th
						add_building = fort_16th
					}
				}
			}
			add_core = 4727
		} 
	}

	sav_szo = {
		icon = assert_our_sovereignty
		position = 4
		required_missions = { sav_mfa } 
		provinces_to_highlight = {  
			province_id = 4727
			NOT = { 
				AND = { 
					owned_by = ROOT 
					is_core = ROOT 
				}
			}
		} 

		trigger = { owns_core_province = 4727 } 

		effect = {  
			add_country_modifier = { 
				name = sav_szo_mod
				duration = 18250
			}
		} 
	}

	sav_nice = {
		icon = renaissance_city
		position = 5
		required_missions = { sav_reorganize } 
		provinces_to_highlight = {  
			province_id = 102
			NOT = { 
				AND = { 
					owned_by = ROOT 
					is_core = ROOT 
					has_shipyard_building_trigger = yes 
					base_production = 10
				}
			}
		} 

		trigger = {  
			102 = { 
				owned_by = ROOT 
				is_core = ROOT 
				has_shipyard_building_trigger = yes 
				base_production = 10
			}
		} 

		effect = {  
			102 = { 
				add_province_triggered_modifier = sav_nice_mod 
				change_trade_goods = cloth
			}
			country_event = { id = aetas_sav.7 }
		} 
	}
}
sav_branch_5 = {
	slot = 5
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { 
		OR = { 
			tag = SAV 
			tag = SPI 
			tag = SCI
			tag = SVY
		}
	} 

	sav_ducal = {
		icon = mission_amedeo_viii
		position = 1
		provinces_to_highlight = {  } 

		trigger = {  
			custom_trigger_tooltip = { 
				tooltip = sav_ducal.tt
				has_country_flag = sav_duchy
			}
		} 

		effect = {  
			add_country_modifier = { 
				name = sav_duchy_mod
				duration = 7300
			}
		} 
	}

	sav_charters = {
		icon = mission_geneva
		position = 2
		required_missions = { sav_ducal } 
		provinces_to_highlight = {  
			area = savoy_dauphine_area
			owned_by = ROOT 
			NOT = { 
				AND = { 
					num_of_times_improved = 5
					OR = { 
						has_tax_building_trigger = yes 
						has_trade_building_trigger = yes 
					}
				}
			}
		} 

		trigger = {  
			num_of_owned_provinces_with = { 
				area = savoy_dauphine_area
				num_of_times_improved = 5
				OR = { 
					has_tax_building_trigger = yes 
					has_trade_building_trigger = yes 
				}
				value = 4
			}
		} 

		effect = {  
			savoy_dauphine_area	= {
				limit = { owned_by = ROOT }
				add_province_modifier = { 
					name = savoy_charters
					duration = 18250
				}
			}
		} 
	}

	sav_patronize_piedmont = {
		icon = mission_the_caucasus_rus
		position = 3
		required_missions = { sav_charters } 
		provinces_to_highlight = {  
			OR = { 
				area = piedmont_area
				area = southern_piedmont_area
			}
			owned_by = ROOT 
			NOT = { 
				AND = {
					num_of_times_improved = 5
					OR = { 
						has_tax_building_trigger = yes 
						has_trade_building_trigger = yes 
					}
				}
			}
		} 

		trigger = {  
			OR = { 
				accepted_culture = piedmontese
				primary_culture = piedmontese
			}
			num_of_owned_provinces_with = { 
				OR = { 
					area = piedmont_area
					area = southern_piedmont_area
				}
				num_of_times_improved = 5
				OR = { 
					has_tax_building_trigger = yes 
					has_trade_building_trigger = yes 
				}
				value = 5
			}
		} 

		effect = {  
			piedmont_area = {
				limit = { owned_by = ROOT }
				add_province_modifier = { 
					name = savoy_charters
					duration = 18250
				}
			}
			southern_piedmont_area = {
				limit = { owned_by = ROOT }
				add_province_modifier = { 
					name = savoy_charters
					duration = 18250
				}
			}
		} 
	}

	sav_reorganize = {
		icon = mission_emmanuel
		position = 4
		required_missions = {
			sav_patronize_piedmont
			sav_fortify
		}
		provinces_to_highlight = {  
			OR = { 
				province_id = 205
				province_id = 5044
				province_id = 103
				province_id = 5040
				province_id = 102
			}
			NOT = { 
				AND = { 
					owned_by = ROOT 
					is_core = ROOT 
				}
			}
		} 

		trigger = {  
			owns_core_province = 205
			owns_core_province =  5044
			owns_core_province = 103
			owns_core_province = 5040
			owns_core_province = 102 
			is_at_war = no 
			stability = 2
			accepted_culture = piedmontese 
			OR = { 
				has_idea_group = administrative_ideas
				has_idea_group = innovativeness_ideas
			}
			NOT = { alliance_with = FRA }
		} 

		effect = { 
			add_government_reform = reorganized_savoy_reform
			country_event = { id = new_flavour_sav.1 }
		} 
	}

	sav_torino = {
		icon = powerhouse_of_the_north
		position = 5
		required_missions = { sav_reorganize } 
		provinces_to_highlight = {  
			province_id = 103
			NOT = { 
				AND = { 
					owned_by = ROOT 
					is_core = ROOT 
					OR = { 
						is_capital = yes 
						has_building = courthouse 
					}
					development = 30
				}
			}
		} 

		trigger = { 
			103 = { 
				owned_by = ROOT 
				is_core = ROOT 
				OR = { 
					is_capital = yes 
					has_building = courthouse 
				}
				has_tax_building_trigger= yes 
				has_trade_building_trigger = yes 
				has_production_building_trigger = yes 
				development = 30
			}
		} 

		effect = {  
			103 = {
				add_province_triggered_modifier = sav_turin_mod
				add_great_project_tier = { 
					type = ai_venaria
					tier = 2
				}
			}
		} 
	}
}
sav_king_sardinia_branch_4 = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			AND = { 
				OR = { 
					tag = SAV
					tag = SVY
				}
				has_country_flag = sav_sar_missions
			}
			tag = SPI
		}
	}

	sav_sar_king = {
		icon = unite_with_sardinia
		position = 6
		required_missions = { sav_nice } 
		provinces_to_highlight = {  
			area = corsica_sardinia_area
			NOT = {  
				AND = { 
					owned_by = ROOT 
					is_core = ROOT 
				}
			}
		} 

		trigger = {  
			corsica_sardinia_area = { 
				owned_by = ROOT 
				is_core = ROOT 
				type = all 
			}
			NOT = { exists = SAR }
		} 

		effect = {  
			add_accepted_culture = sardinian 
			change_tag = SPI 
			on_change_tag_effect = yes
			remove_non_electors_emperors_from_empire_effect = yes
			if = {
				limit = {
					NOT = {
						government_rank = 2
					}
				}
				set_government_rank = 2
			}
			if = {
				limit = { has_custom_ideas = no }
				country_event = { id = ideagroups.1 } #Swap Ideas
			}
			swap_non_generic_missions = yes 
			if = {
				limit = { mission_completed = sav_mlo }
				po_valley_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				emilia_romagna_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
			}
			if = { 
				limit = { mission_completed = sav_gen }
				tuscany_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
			}
		} 
	}
}
sav_king_sicily_branch_4 = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			AND = { 
				OR = { 
					tag = SAV
					tag = SVY
				}
				has_country_flag = sav_sic_missions
			}
			tag = SCI
		}
	}

	sav_sic_king = {
		icon = king_of_sicily
		position = 6
		required_missions = { sav_nice } 
		provinces_to_highlight = {  
			area = sicily_area
			NOT = {  
				AND = { 
					owned_by = ROOT 
					is_core = ROOT 
				}
			}
		} 

		trigger = {  
			sicily_area = { 
				owned_by = ROOT 
				is_core = ROOT 
				type = all 
			}
			NOT = { exists = SIC }
		} 

		effect = {  
			add_accepted_culture = sicilian 
			change_tag = SCI
			on_change_tag_effect = yes
			remove_non_electors_emperors_from_empire_effect = yes
			if = {
				limit = {
					NOT = {
						government_rank = 2
					}
				}
				set_government_rank = 2
			}
			if = {
				limit = { has_custom_ideas = no }
				country_event = { id = ideagroups.1 } #Swap Ideas
			}
			swap_non_generic_missions = yes 
			if = {
				limit = { mission_completed = sav_mlo }
				po_valley_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
				emilia_romagna_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
			}
			if = { 
				limit = { mission_completed = sav_gen }
				tuscany_area = {
					limit = {
						NOT = { is_permanent_claim = ROOT } 
						NOT = { is_core = ROOT } 
					}
					add_permanent_claim = ROOT
				}
			}
		} 
	}
}
spi_branch_1 = {
	slot = 1
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = SPI
			tag = SCI
		}
	}

	spi_brc = {
		icon = fra_refine_bombards
		position = 6
		required_missions = { sav_mlo } 
		provinces_to_highlight = {  
			area = po_valley_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			po_valley_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
		} 

		effect = {  
			venetia_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}

	spi_ven = {
		icon = nuova_promissione_ducale
		position = 7
		required_missions = { spi_brc } 
		provinces_to_highlight = {  
			area = venetia_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			venetia_area = { 
				country_or_non_sovereign_subject_holds = ROOT
				type = all 
			}
		} 

		effect = {  
			add_country_modifier = { 
				name = sav_ven_mod
				duration = -1
			}
			frioul_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}

	spi_marche = {
		icon = up_the_adige
		position = 8
		required_missions = { spi_rmg } 
		provinces_to_highlight = {  
			area = central_italy_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			central_italy_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
		} 

		effect = {  
			add_country_modifier = { 
				name = sav_marche
				duration = 7300
			}
		} 
	}
}
spi_branch_2 = {
	slot = 2
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = SPI
			tag = SCI
		}
	}

	spi_emilia = {
		icon = protect_against_austria
		position = 6
		required_missions = {
			sav_mlo
			sav_gen
		}
		provinces_to_highlight = {  
			area = emilia_romagna_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			emilia_romagna_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
		} 

		effect = {  
			emilia_romagna_area = { 
				random_area_province = { 
					add_base_tax = 1
					add_base_production = 1
				}
			}
			romagna_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}

	spi_rmg = {
		icon = sweep_the_po
		position = 7
		required_missions = { spi_emilia } 
		provinces_to_highlight = {  
			area = romagna_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			romagna_area = { 
				country_or_non_sovereign_subject_holds = ROOT
				type = all 
			}
		} 

		effect = {  
			add_country_modifier = { 
				name = sav_rmg
				duration = 18250
			}
			umbria_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}

	spi_umbria = {
		icon = fortress_switzerland
		position = 8
		required_missions = { spi_rmg } 
		provinces_to_highlight = {  
			area = umbria_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			umbria_area = { 
				country_or_non_sovereign_subject_holds = ROOT
				type = all 
			}
		} 

		effect = {  
			add_country_modifier = {
				name = sav_umbria
				duration = 18250
			}
			lazio_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}
}
spi_branch_3 = {
	slot = 3
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = SPI
			tag = SCI
		}
	}

	spi_lan = {
		icon = conquer_tuscany
		position = 6
		required_missions = { sav_gen } 
		provinces_to_highlight = {  
			area = tuscany_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			tuscany_area = { 
				country_or_non_sovereign_subject_holds = ROOT
				type = all 
			}
		} 

		effect = {  
			116 = { 
				add_base_tax = 1
				add_base_production = 1
				add_base_manpower = 1 
			}
			south_tuscany_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}

	spi_sie = {
		icon = ansbach_succession
		position = 7
		required_missions = { spi_lan } 
		provinces_to_highlight = {  
			area = south_tuscany_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			south_tuscany_area = {
				country_or_non_sovereign_subject_holds = ROOT
				type = all 
			}
		} 

		effect = {  
			add_country_modifier = { 
				name = sav_tus
				duration = -1 
			}
		} 
	}

	spi_rom = {
		icon = new_st_peters_basilica
		position = 8
		required_missions = { spi_sie } 
		provinces_to_highlight = {  
			area = lazio_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			lazio_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
		} 

		effect = {  
			118 = { 
				add_base_tax = 1 
				add_base_production = 1
				add_base_manpower = 1
			}
			add_country_modifier = { 
				name = sav_rome
				duration = -1
			}
		} 
	}
}
spi_sar_branch_4 = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = SPI } 

	spi_sar_dev = {
		icon = capture_adriatic_ports
		position = 7
		required_missions = {
			sav_sar_king
			spi_piedmont
		}
		provinces_to_highlight = {  
			area = corsica_sardinia_area
			owned_by = ROOT 
			NOT = { 
				AND = { 
					num_of_times_improved = 5
					has_production_building_trigger = yes 
				}
			}
		} 

		trigger = {  
			accepted_culture = sardinian 
			num_of_owned_provinces_with = { 
				area = corsica_sardinia_area
				num_of_times_improved = 5
				has_production_building_trigger = yes 
				value = 4
			}
		} 

		effect = {  
			5009 = { change_trade_goods = gold }
			4735 = { change_trade_goods = gems }
			corsica_sardinia_area = {
				limit = { 
					OR = { 
						trade_goods = gold
						trade_goods = gems 
						trade_goods = coal 
					}
				}
				add_province_triggered_modifier = sav_sar_mod
			}
		} 
	}
}
spi_sic_branch_4 = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = SCI } 

	spi_sic_dev = {
		icon = develop_provence
		position = 7
		required_missions = {
			sav_sic_king
			spi_piedmont
		}
		provinces_to_highlight = {  
			area = sicily_area
			NOT = { 
				AND = { 
					owned_by = ROOT 
					is_core = ROOT 
					num_of_times_improved = 5
					has_tax_building_trigger = yes 
					has_trade_building_trigger = yes 
				}
			}
		} 

		trigger = {  
			sicily_area = { 
				owned_by = ROOT 
				is_core = ROOT 
				num_of_times_improved = 5
				has_tax_building_trigger = yes 
				has_trade_building_trigger = yes 
				type = all 
			}
			125 = { has_manufactory_trigger = yes }
		} 

		effect = {  
			country_event = { id = aetas_sav.8 }
		} 
	}
}
spi_branch_4 = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = SPI
			tag = SCI
		}
	}

	sav_nap = {
		icon = king_of_naples
		position = 8
		required_missions = { spi_fusion } 
		provinces_to_highlight = {  
			OR = { 
				area = naples_area
				area = abruzzo_area
				area = capitanate_area
				area = apulia_area
				area = calabria_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			121 = { country_or_non_sovereign_subject_holds = ROOT }
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = { 
				OR = { 
					area = naples_area
					area = abruzzo_area
					area = capitanate_area
					area = apulia_area
					area = calabria_area
				}
				value = 25
			}
		} 

		effect = {  
			add_country_modifier = { 
				name = sav_expedition
				duration = 36400
			}
		} 
	}
}
spi_branch_5 = {
	slot = 5
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = SPI
			tag = SCI
		}
	}

	spi_piedmont = {
		icon = prosper_in_piedmont
		position = 6
		required_missions = {
			sav_nice
			sav_torino
		}
		provinces_to_highlight = {  
			OR = { 
				area = piedmont_area
				area = southern_piedmont_area
			}
			NOT = { 
				AND = { 
					owned_by = ROOT 
					is_core = ROOT 
					has_manufactory_trigger = yes
					num_of_times_improved = 10
				}
			}
		} 

		trigger = {  
			piedmont_area = { 
				owned_by = ROOT
				is_core = ROOT 
				type = all 
			}
			southern_piedmont_area = {
				owned_by = ROOT
				is_core = ROOT 
				type = all 
			}
			num_of_owned_provinces_with = { 
				OR = {
					area = piedmont_area 
					area = southern_piedmont_area
				}
				has_manufactory_trigger = yes 
				num_of_times_improved = 10
				value = 10
			}
		} 

		effect = {  
			add_country_modifier = {
				name = sav_alpine_powerhouse
				duration = -1
			}
		} 
	}

	spi_fusion = {
		icon = geneva_conventions
		position = 7
		required_missions = { spi_piedmont } 
		provinces_to_highlight = {  } 

		trigger = {  
			government_rank = 2 
			has_reform = reorganized_savoy_reform
			adm = 5 
			reform_level = 10
		} 

		effect = { 
			if = { 
				limit = { has_reform = savoy_reform }
				remove_government_reform = savoy_reform 
			}
			else = { remove_government_reform = reorganized_savoy_reform }
			add_government_reform = savoy_kingdom_reform 
		} 
	}

	spi_risorgimento = {
		icon = establish_client_states
		position = 9
		required_missions = {
			spi_fusion
			spi_marche
			spi_umbria
			spi_rom
			sav_nap
		}
		provinces_to_highlight = {  
			region = italy_region 
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			italy_region = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
		} 

		effect = {  
			add_country_modifier = { 
				name = risorgimento #missing loc
				duration = -1
			}
		} 
	}
}
spi_locked_branch_1 = {
	slot = 1
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { 
		OR = { 
			tag = SAV
			tag = SVY
		}
	} 

	spi_locked_1a = {
		icon = mission_locked_mission
		position = 6
		required_missions = { sav_mlo } 
		provinces_to_highlight = {  
			area = po_valley_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			po_valley_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
		} 

		effect = {  
			custom_tooltip = spi_unlock_mission.tt
			venetia_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}

	spi_locked_1b = {
		icon = mission_locked_mission
		position = 7
		required_missions = { spi_locked_1a } 
		provinces_to_highlight = {  
			area = venetia_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			venetia_area = { 
				country_or_non_sovereign_subject_holds = ROOT
				type = all 
			}
		} 

		effect = {  
			custom_tooltip = spi_unlock_mission.tt
			add_country_modifier = { 
				name = sav_ven_mod
				duration = -1
			}
			frioul_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}

	spi_locked_1c = {
		icon = mission_locked_mission
		position = 8
		required_missions = { spi_locked_2b } 
		provinces_to_highlight = {  
			area = central_italy_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			central_italy_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
		} 

		effect = {  
			custom_tooltip = spi_unlock_mission.tt
			add_country_modifier = { 
				name = sav_marche
				duration = 7300
			}
		} 
	}
}
spi_locked_branch_2 = {
	slot = 2
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { 
		OR = { 
			tag = SAV
			tag = SVY
		}
	} 

	spi_locked_2a = {
		icon = mission_locked_mission
		position = 6
		required_missions = {
			sav_mlo
			sav_gen
		}
		provinces_to_highlight = {  
			area = emilia_romagna_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			emilia_romagna_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
		} 

		effect = {  
			custom_tooltip = spi_unlock_mission.tt
			emilia_romagna_area = { 
				random_area_province = { 
					add_base_tax = 1
					add_base_production = 1
				}
			}
			romagna_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}

	spi_locked_2b = {
		icon = mission_locked_mission
		position = 7
		required_missions = { spi_locked_2a } 
		provinces_to_highlight = {  
			area = romagna_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			romagna_area = { 
				country_or_non_sovereign_subject_holds = ROOT
				type = all 
			}
		} 

		effect = {  
			custom_tooltip = spi_unlock_mission.tt
			add_country_modifier = { 
				name = sav_rmg
				duration = 18250
			}
			umbria_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}

	spi_locked_2c = {
		icon = mission_locked_mission
		position = 8
		required_missions = { spi_locked_2b } 
		provinces_to_highlight = {  
			area = umbria_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			umbria_area = { 
				country_or_non_sovereign_subject_holds = ROOT
				type = all 
			}
		} 

		effect = {  
			custom_tooltip = spi_unlock_mission.tt
			add_country_modifier = {
				name = sav_umbria
				duration = 18250
			}
			lazio_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}
}
spi_locked_branch_3 = {
	slot = 3
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { 
		OR = { 
			tag = SAV
			tag = SVY
		}
	} 

	spi_locked_3a = {
		icon = mission_locked_mission
		position = 6
		required_missions = { sav_gen } 
		provinces_to_highlight = {  
			area = tuscany_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			tuscany_area = { 
				country_or_non_sovereign_subject_holds = ROOT
				type = all 
			}
		} 

		effect = {  
			custom_tooltip = spi_unlock_mission.tt
			116 = { 
				add_base_tax = 1
				add_base_production = 1
				add_base_manpower = 1 
			}
			south_tuscany_area = {
				limit = {
					NOT = { is_permanent_claim = ROOT } 
					NOT = { is_core = ROOT } 
				}
				add_permanent_claim = ROOT
			}
		} 
	}

	spi_locked_3b = {
		icon = mission_locked_mission
		position = 7
		required_missions = { spi_locked_3a } 
		provinces_to_highlight = {  
			area = south_tuscany_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			south_tuscany_area = {
				country_or_non_sovereign_subject_holds = ROOT
				type = all 
			}
		} 

		effect = {  
			custom_tooltip = spi_unlock_mission.tt
			add_country_modifier = { 
				name = sav_tus
				duration = -1 
			}
		} 
	}

	spi_locked_3c = {
		icon = mission_locked_mission
		position = 8
		required_missions = { spi_locked_3b } 
		provinces_to_highlight = {  
			area = lazio_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			lazio_area = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
		} 

		effect = {  
			custom_tooltip = spi_unlock_mission.tt
			118 = { 
				add_base_tax = 1 
				add_base_production = 1
				add_base_manpower = 1
			}
			add_country_modifier = { 
				name = sav_rome
				duration = -1
			}
		} 
	}
}
spi_branching_branch_4 = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = { 
			tag = SAV
			tag = SVY
		}
		NOT = {
			OR = {
				has_country_flag = sav_sar_missions
				has_country_flag = sav_sic_missions
			}
		}
	}

	spi_branching_4a = {
		icon = mission_unknown_mission
		position = 6
		required_missions = { sav_nice } 
		provinces_to_highlight = {  } 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			OR = { 
				AND = { 
					corsica_sardinia_area = { 
						owned_by = ROOT 
						is_core = ROOT 
						type = all 
					}
					NOT = { exists = SAR }
				}
				AND = { 
					sicily_area = { 
						owned_by = ROOT 
						is_core = ROOT 
						type = all 
					}
					NOT = { exists = SIC }
				}
			}
		} 

		effect = { custom_tooltip = spi_unlock_mission.tt } 
	}
}
spi_locked_branch_4 = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { 
		OR = { 
			tag = SAV
			tag = SVY
		}
	} 

	spi_locked_4b = {
		icon = mission_locked_mission
		position = 7
		required_missions = {
			spi_branching_4a
			spi_locked_5a
		}
		provinces_to_highlight = {  } 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			OR = { 
				AND = {
					accepted_culture = sardinian 
					num_of_owned_provinces_with = { 
						area = corsica_sardinia_area
						num_of_times_improved = 5
						has_production_building_trigger = yes 
						value = 4
					}
				}
				AND = { 
					accepted_culture = sicilian
					125 = { 
						owned_by = ROOT 
						is_core = ROOT 
						num_of_times_improved = 10
						has_tax_building_trigger = yes 
						has_trade_building_trigger = yes 
					}
				}
			}
		} 

		effect = { custom_tooltip = spi_unlock_mission.tt } 
	}

	spi_locked_4c = {
		icon = mission_locked_mission
		position = 8
		required_missions = { spi_locked_5b } 
		provinces_to_highlight = {  
			OR = { 
				area = naples_area
				area = abruzzo_area
				area = capitanate_area
				area = apulia_area
				area = calabria_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			121 = { country_or_non_sovereign_subject_holds = ROOT }
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = { 
				OR = { 
					area = naples_area
					area = abruzzo_area
					area = capitanate_area
					area = apulia_area
					area = calabria_area
				}
				value = 25
			}
		} 

		effect = {  
			custom_tooltip = spi_unlock_mission.tt
			add_country_modifier = { 
				name = sav_expedition
				duration = 36400
			}
		} 
	}
}
spi_locked_branch_5 = {
	slot = 5
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { 
		OR = { 
			tag = SAV
			tag = SVY
		}
	} 

	spi_locked_5a = {
		icon = mission_locked_mission
		position = 6
		required_missions = {
			sav_nice
			sav_torino
		}
		provinces_to_highlight = {  
			OR = { 
				area = piedmont_area
				area = southern_piedmont_area
			}
			NOT = { 
				AND = { 
					owned_by = ROOT 
					is_core = ROOT 
					has_manufactory_trigger = yes
					num_of_times_improved = 10
				}
			}
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			piedmont_area = { 
				owned_by = ROOT
				is_core = ROOT 
				type = all 
			}
			southern_piedmont_area = {
				owned_by = ROOT
				is_core = ROOT 
				type = all 
			}
			num_of_owned_provinces_with = { 
				OR = {
					area = piedmont_area 
					area = southern_piedmont_area
				}
				has_manufactory_trigger = yes 
				num_of_times_improved = 10
				value = 10
			}
		} 

		effect = {  
			custom_tooltip = spi_unlock_mission.tt
			add_country_modifier = {
				name = sav_alpine_powerhouse
				duration = -1
			}
		} 
	}

	spi_locked_5b = {
		icon = mission_locked_mission
		position = 7
		required_missions = { spi_locked_5a } 
		provinces_to_highlight = {  } 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			government_rank = 2 
			has_reform = reorganized_savoy_reform
			adm = 5 
			reform_level = 10
		} 

		effect = { 
			custom_tooltip = spi_unlock_mission.tt
			if = { 
				limit = { has_reform = savoy_reform }
				remove_government_reform = savoy_reform 
			}
			else = { remove_government_reform = reorganized_savoy_reform }
			add_government_reform = savoy_kingdom_reform
		} 
	}

	spi_locked_5d = {
		icon = mission_locked_mission
		position = 9
		required_missions = {
			spi_locked_1c
			spi_locked_2c
			spi_locked_3c
			spi_locked_4c
			spi_locked_5b
		}
		provinces_to_highlight = {  
			region = italy_region 
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		} 

		trigger = {  
			custom_trigger_tooltip = {
				tooltip = selectable_mission_trigger_tt
				always = no
			}
			italy_region = { 
				country_or_non_sovereign_subject_holds = ROOT 
				type = all 
			}
		} 

		effect = {  
			custom_tooltip = spi_unlock_mission.tt
			add_country_modifier = { 
				name = risorgimento #missing loc
				duration = -1
			}
		} 
	}
}
